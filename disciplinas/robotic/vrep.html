<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 8.6.9">
<title></title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }


/*
 * xhtml11 specific
 *
 * */

tt {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


/*
 * Theme specific overrides of the preceding (asciidoc.css) CSS.
 *
 */
body {
  font-family: Garamond, Georgia, serif;
  font-size: 17px;
  color: #3E4349;
  line-height: 1.3em;
}
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Garmond, Georgia, serif;
  font-weight: normal;
  border-bottom-width: 0;
  color: #3E4349;
}
div.title, caption.title { color: #596673; font-weight: bold; }
h1 { font-size: 240%; }
h2 { font-size: 180%; }
h3 { font-size: 150%; }
h4 { font-size: 130%; }
h5 { font-size: 115%; }
h6 { font-size: 100%; }
#header h1 { margin-top: 0; }
#toc {
  color: #444444;
  line-height: 1.5;
  padding-top: 1.5em;
}
#toctitle {
  font-size: 20px;
}
#toc a {
    border-bottom: 1px dotted #999999;
    color: #444444 !important;
    text-decoration: none !important;
}
#toc a:hover {
    border-bottom: 1px solid #6D4100;
    color: #6D4100 !important;
    text-decoration: none !important;
}
div.toclevel1 { margin-top: 0.2em; font-size: 16px; }
div.toclevel2 { margin-top: 0.15em; font-size: 14px; }
em, dt, td.hdlist1 { color: black; }
strong { color: #3E4349; }
a { color: #004B6B; text-decoration: none; border-bottom: 1px dotted #004B6B; }
a:visited { color: #615FA0; border-bottom: 1px dotted #615FA0; }
a:hover { color: #6D4100; border-bottom: 1px solid #6D4100; }
div.tableblock > table, table.tableblock { border: 3px solid #E8E8E8; }
th.tableblock, td.tableblock { border: 1px solid #E8E8E8; }
ul > li > * { color: #3E4349; }
pre, tt, .monospaced { font-family: Consolas,Menlo,'Deja Vu Sans Mono','Bitstream Vera Sans Mono',monospace; }
tt, .monospaced { font-size: 0.9em; color: black;
}
div.exampleblock > div.content, div.sidebarblock > div.content, div.listingblock > div.content { border-width: 0 0 0 3px; border-color: #E8E8E8; }
div.verseblock { border-left-width: 0; margin-left: 3em; }
div.quoteblock { border-left-width: 3px; margin-left: 0; margin-right: 0;}
div.admonitionblock td.content { border-left: 3px solid #E8E8E8; }


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
<script type="text/javascript">
/*<![CDATA[*/
/*
LaTeXMathML.js
==============

This file, in this form, is due to Douglas Woodall, June 2006.
It contains JavaScript functions to convert (most simple) LaTeX
math notation to Presentation MathML.  It was obtained by
downloading the file ASCIIMathML.js from
	http://www1.chapman.edu/~jipsen/mathml/asciimathdownload/
and modifying it so that it carries out ONLY those conversions
that would be carried out in LaTeX.  A description of the original
file, with examples, can be found at
	www1.chapman.edu/~jipsen/mathml/asciimath.html
	ASCIIMathML: Math on the web for everyone

Here is the header notice from the original file:

ASCIIMathML.js
==============
This file contains JavaScript functions to convert ASCII math notation
to Presentation MathML. The conversion is done while the (X)HTML page
loads, and should work with Firefox/Mozilla/Netscape 7+ and Internet
Explorer 6+MathPlayer (http://www.dessci.com/en/products/mathplayer/).
Just add the next line to your (X)HTML page with this file in the same folder:
This is a convenient and inexpensive solution for authoring MathML.

Version 1.4.7 Dec 15, 2005, (c) Peter Jipsen http://www.chapman.edu/~jipsen
Latest version at http://www.chapman.edu/~jipsen/mathml/ASCIIMathML.js
For changes see http://www.chapman.edu/~jipsen/mathml/asciimathchanges.txt
If you use it on a webpage, please send the URL to jipsen@chapman.edu

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or (at
your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
General Public License (at http://www.gnu.org/copyleft/gpl.html)
for more details.

LaTeXMathML.js (ctd)
==============

The instructions for use are the same as for the original
ASCIIMathML.js, except that of course the line you add to your
file should be
Or use absolute path names if the file is not in the same folder
as your (X)HTML page.
*/

var checkForMathML = true;   // check if browser can display MathML
var notifyIfNoMathML = true; // display note if no MathML capability
var alertIfNoMathML = false;  // show alert box if no MathML capability
// was "red":
var mathcolor = "";	     // change it to "" (to inherit) or any other color
// was "serif":
var mathfontfamily = "";      // change to "" to inherit (works in IE)
                              // or another family (e.g. "arial")
var showasciiformulaonhover = true; // helps students learn ASCIIMath
/*
// Commented out by DRW -- not now used -- see DELIMITERS (twice) near the end
var displaystyle = false;     // puts limits above and below large operators
var decimalsign = ".";        // change to "," if you like, beware of `(1,2)`!
var AMdelimiter1 = "`", AMescape1 = "\\\\`"; // can use other characters
var AMdelimiter2 = "$", AMescape2 = "\\\\\\$", AMdelimiter2regexp = "\\$";
var doubleblankmathdelimiter = false; // if true,  x+1  is equal to `x+1`
                                      // for IE this works only in <!--   -->
//var separatetokens;// has been removed (email me if this is a problem)
*/
var isIE = document.createElementNS==null;

if (document.getElementById==null)
  alert("This webpage requires a recent browser such as\
\nMozilla/Netscape 7+ or Internet Explorer 6+MathPlayer")

// all further global variables start with "AM"

function AMcreateElementXHTML(t) {
  if (isIE) return document.createElement(t);
  else return document.createElementNS("http://www.w3.org/1999/xhtml",t);
}

function AMnoMathMLNote() {
  var nd = AMcreateElementXHTML("h3");
  nd.setAttribute("align","center")
  nd.appendChild(AMcreateElementXHTML("p"));
  nd.appendChild(document.createTextNode("To view the "));
  var an = AMcreateElementXHTML("a");
  an.appendChild(document.createTextNode("LaTeXMathML"));
  an.setAttribute("href","http://www.maths.nott.ac.uk/personal/drw/lm.html");
  nd.appendChild(an);
  nd.appendChild(document.createTextNode(" notation use Internet Explorer 6+"));
  an = AMcreateElementXHTML("a");
  an.appendChild(document.createTextNode("MathPlayer"));
  an.setAttribute("href","http://www.dessci.com/en/products/mathplayer/download.htm");
  nd.appendChild(an);
  nd.appendChild(document.createTextNode(" or Netscape/Mozilla/Firefox"));
  nd.appendChild(AMcreateElementXHTML("p"));
  return nd;
}

function AMisMathMLavailable() {
  if (navigator.appName.slice(0,8)=="Netscape")
    if (navigator.appVersion.slice(0,1)>="5") return null;
    else return AMnoMathMLNote();
  else if (navigator.appName.slice(0,9)=="Microsoft")
    try {
        var ActiveX = new ActiveXObject("MathPlayer.Factory.1");
        return null;
    } catch (e) {
        return AMnoMathMLNote();
    }
  else return AMnoMathMLNote();
}

// character lists for Mozilla/Netscape fonts
var AMcal = [0xEF35,0x212C,0xEF36,0xEF37,0x2130,0x2131,0xEF38,0x210B,0x2110,0xEF39,0xEF3A,0x2112,0x2133,0xEF3B,0xEF3C,0xEF3D,0xEF3E,0x211B,0xEF3F,0xEF40,0xEF41,0xEF42,0xEF43,0xEF44,0xEF45,0xEF46];
var AMfrk = [0xEF5D,0xEF5E,0x212D,0xEF5F,0xEF60,0xEF61,0xEF62,0x210C,0x2111,0xEF63,0xEF64,0xEF65,0xEF66,0xEF67,0xEF68,0xEF69,0xEF6A,0x211C,0xEF6B,0xEF6C,0xEF6D,0xEF6E,0xEF6F,0xEF70,0xEF71,0x2128];
var AMbbb = [0xEF8C,0xEF8D,0x2102,0xEF8E,0xEF8F,0xEF90,0xEF91,0x210D,0xEF92,0xEF93,0xEF94,0xEF95,0xEF96,0x2115,0xEF97,0x2119,0x211A,0x211D,0xEF98,0xEF99,0xEF9A,0xEF9B,0xEF9C,0xEF9D,0xEF9E,0x2124];

var CONST = 0, UNARY = 1, BINARY = 2, INFIX = 3, LEFTBRACKET = 4,
    RIGHTBRACKET = 5, SPACE = 6, UNDEROVER = 7, DEFINITION = 8,
    TEXT = 9, BIG = 10, LONG = 11, STRETCHY = 12, MATRIX = 13; // token types

var AMsqrt = {input:"\\sqrt",	tag:"msqrt", output:"sqrt",	ttype:UNARY},
  AMroot = {input:"\\root",	tag:"mroot", output:"root",	ttype:BINARY},
  AMfrac = {input:"\\frac",	tag:"mfrac", output:"/",	ttype:BINARY},
  AMover = {input:"\\stackrel", tag:"mover", output:"stackrel", ttype:BINARY},
  AMatop = {input:"\\atop",	tag:"mfrac", output:"",		ttype:INFIX},
  AMchoose = {input:"\\choose", tag:"mfrac", output:"",		ttype:INFIX},
  AMsub  = {input:"_",		tag:"msub",  output:"_",	ttype:INFIX},
  AMsup  = {input:"^",		tag:"msup",  output:"^",	ttype:INFIX},
  AMtext = {input:"\\mathrm",	tag:"mtext", output:"text",	ttype:TEXT},
  AMmbox = {input:"\\mbox",	tag:"mtext", output:"mbox",	ttype:TEXT};

// Commented out by DRW to prevent 1/2 turning into a 2-line fraction
// AMdiv   = {input:"/",	 tag:"mfrac", output:"/",    ttype:INFIX},
// Commented out by DRW so that " prints literally in equations
// AMquote = {input:"\"",	 tag:"mtext", output:"mbox", ttype:TEXT};

var AMsymbols = [
//Greek letters
{input:"\\alpha",	tag:"mi", output:"\u03B1", ttype:CONST},
{input:"\\beta",	tag:"mi", output:"\u03B2", ttype:CONST},
{input:"\\gamma",	tag:"mi", output:"\u03B3", ttype:CONST},
{input:"\\delta",	tag:"mi", output:"\u03B4", ttype:CONST},
{input:"\\epsilon",	tag:"mi", output:"\u03B5", ttype:CONST},
{input:"\\varepsilon",  tag:"mi", output:"\u025B", ttype:CONST},
{input:"\\zeta",	tag:"mi", output:"\u03B6", ttype:CONST},
{input:"\\eta",		tag:"mi", output:"\u03B7", ttype:CONST},
{input:"\\theta",	tag:"mi", output:"\u03B8", ttype:CONST},
{input:"\\vartheta",	tag:"mi", output:"\u03D1", ttype:CONST},
{input:"\\iota",	tag:"mi", output:"\u03B9", ttype:CONST},
{input:"\\kappa",	tag:"mi", output:"\u03BA", ttype:CONST},
{input:"\\lambda",	tag:"mi", output:"\u03BB", ttype:CONST},
{input:"\\mu",		tag:"mi", output:"\u03BC", ttype:CONST},
{input:"\\nu",		tag:"mi", output:"\u03BD", ttype:CONST},
{input:"\\xi",		tag:"mi", output:"\u03BE", ttype:CONST},
{input:"\\pi",		tag:"mi", output:"\u03C0", ttype:CONST},
{input:"\\varpi",	tag:"mi", output:"\u03D6", ttype:CONST},
{input:"\\rho",		tag:"mi", output:"\u03C1", ttype:CONST},
{input:"\\varrho",	tag:"mi", output:"\u03F1", ttype:CONST},
{input:"\\varsigma",	tag:"mi", output:"\u03C2", ttype:CONST},
{input:"\\sigma",	tag:"mi", output:"\u03C3", ttype:CONST},
{input:"\\tau",		tag:"mi", output:"\u03C4", ttype:CONST},
{input:"\\upsilon",	tag:"mi", output:"\u03C5", ttype:CONST},
{input:"\\phi",		tag:"mi", output:"\u03C6", ttype:CONST},
{input:"\\varphi",	tag:"mi", output:"\u03D5", ttype:CONST},
{input:"\\chi",		tag:"mi", output:"\u03C7", ttype:CONST},
{input:"\\psi",		tag:"mi", output:"\u03C8", ttype:CONST},
{input:"\\omega",	tag:"mi", output:"\u03C9", ttype:CONST},
{input:"\\Gamma",	tag:"mo", output:"\u0393", ttype:CONST},
{input:"\\Delta",	tag:"mo", output:"\u0394", ttype:CONST},
{input:"\\Theta",	tag:"mo", output:"\u0398", ttype:CONST},
{input:"\\Lambda",	tag:"mo", output:"\u039B", ttype:CONST},
{input:"\\Xi",		tag:"mo", output:"\u039E", ttype:CONST},
{input:"\\Pi",		tag:"mo", output:"\u03A0", ttype:CONST},
{input:"\\Sigma",	tag:"mo", output:"\u03A3", ttype:CONST},
{input:"\\Upsilon",	tag:"mo", output:"\u03A5", ttype:CONST},
{input:"\\Phi",		tag:"mo", output:"\u03A6", ttype:CONST},
{input:"\\Psi",		tag:"mo", output:"\u03A8", ttype:CONST},
{input:"\\Omega",	tag:"mo", output:"\u03A9", ttype:CONST},

//fractions
{input:"\\frac12",	tag:"mo", output:"\u00BD", ttype:CONST},
{input:"\\frac14",	tag:"mo", output:"\u00BC", ttype:CONST},
{input:"\\frac34",	tag:"mo", output:"\u00BE", ttype:CONST},
{input:"\\frac13",	tag:"mo", output:"\u2153", ttype:CONST},
{input:"\\frac23",	tag:"mo", output:"\u2154", ttype:CONST},
{input:"\\frac15",	tag:"mo", output:"\u2155", ttype:CONST},
{input:"\\frac25",	tag:"mo", output:"\u2156", ttype:CONST},
{input:"\\frac35",	tag:"mo", output:"\u2157", ttype:CONST},
{input:"\\frac45",	tag:"mo", output:"\u2158", ttype:CONST},
{input:"\\frac16",	tag:"mo", output:"\u2159", ttype:CONST},
{input:"\\frac56",	tag:"mo", output:"\u215A", ttype:CONST},
{input:"\\frac18",	tag:"mo", output:"\u215B", ttype:CONST},
{input:"\\frac38",	tag:"mo", output:"\u215C", ttype:CONST},
{input:"\\frac58",	tag:"mo", output:"\u215D", ttype:CONST},
{input:"\\frac78",	tag:"mo", output:"\u215E", ttype:CONST},

//binary operation symbols
{input:"\\pm",		tag:"mo", output:"\u00B1", ttype:CONST},
{input:"\\mp",		tag:"mo", output:"\u2213", ttype:CONST},
{input:"\\triangleleft",tag:"mo", output:"\u22B2", ttype:CONST},
{input:"\\triangleright",tag:"mo",output:"\u22B3", ttype:CONST},
{input:"\\cdot",	tag:"mo", output:"\u22C5", ttype:CONST},
{input:"\\star",	tag:"mo", output:"\u22C6", ttype:CONST},
{input:"\\ast",		tag:"mo", output:"\u002A", ttype:CONST},
{input:"\\times",	tag:"mo", output:"\u00D7", ttype:CONST},
{input:"\\div",		tag:"mo", output:"\u00F7", ttype:CONST},
{input:"\\circ",	tag:"mo", output:"\u2218", ttype:CONST},
//{input:"\\bullet",	  tag:"mo", output:"\u2219", ttype:CONST},
{input:"\\bullet",	tag:"mo", output:"\u2022", ttype:CONST},
{input:"\\oplus",	tag:"mo", output:"\u2295", ttype:CONST},
{input:"\\ominus",	tag:"mo", output:"\u2296", ttype:CONST},
{input:"\\otimes",	tag:"mo", output:"\u2297", ttype:CONST},
{input:"\\bigcirc",	tag:"mo", output:"\u25CB", ttype:CONST},
{input:"\\oslash",	tag:"mo", output:"\u2298", ttype:CONST},
{input:"\\odot",	tag:"mo", output:"\u2299", ttype:CONST},
{input:"\\land",	tag:"mo", output:"\u2227", ttype:CONST},
{input:"\\wedge",	tag:"mo", output:"\u2227", ttype:CONST},
{input:"\\lor",		tag:"mo", output:"\u2228", ttype:CONST},
{input:"\\vee",		tag:"mo", output:"\u2228", ttype:CONST},
{input:"\\cap",		tag:"mo", output:"\u2229", ttype:CONST},
{input:"\\cup",		tag:"mo", output:"\u222A", ttype:CONST},
{input:"\\sqcap",	tag:"mo", output:"\u2293", ttype:CONST},
{input:"\\sqcup",	tag:"mo", output:"\u2294", ttype:CONST},
{input:"\\uplus",	tag:"mo", output:"\u228E", ttype:CONST},
{input:"\\amalg",	tag:"mo", output:"\u2210", ttype:CONST},
{input:"\\bigtriangleup",tag:"mo",output:"\u25B3", ttype:CONST},
{input:"\\bigtriangledown",tag:"mo",output:"\u25BD", ttype:CONST},
{input:"\\dag",		tag:"mo", output:"\u2020", ttype:CONST},
{input:"\\dagger",	tag:"mo", output:"\u2020", ttype:CONST},
{input:"\\ddag",	tag:"mo", output:"\u2021", ttype:CONST},
{input:"\\ddagger",	tag:"mo", output:"\u2021", ttype:CONST},
{input:"\\lhd",		tag:"mo", output:"\u22B2", ttype:CONST},
{input:"\\rhd",		tag:"mo", output:"\u22B3", ttype:CONST},
{input:"\\unlhd",	tag:"mo", output:"\u22B4", ttype:CONST},
{input:"\\unrhd",	tag:"mo", output:"\u22B5", ttype:CONST},


//BIG Operators
{input:"\\sum",		tag:"mo", output:"\u2211", ttype:UNDEROVER},
{input:"\\prod",	tag:"mo", output:"\u220F", ttype:UNDEROVER},
{input:"\\bigcap",	tag:"mo", output:"\u22C2", ttype:UNDEROVER},
{input:"\\bigcup",	tag:"mo", output:"\u22C3", ttype:UNDEROVER},
{input:"\\bigwedge",	tag:"mo", output:"\u22C0", ttype:UNDEROVER},
{input:"\\bigvee",	tag:"mo", output:"\u22C1", ttype:UNDEROVER},
{input:"\\bigsqcap",	tag:"mo", output:"\u2A05", ttype:UNDEROVER},
{input:"\\bigsqcup",	tag:"mo", output:"\u2A06", ttype:UNDEROVER},
{input:"\\coprod",	tag:"mo", output:"\u2210", ttype:UNDEROVER},
{input:"\\bigoplus",	tag:"mo", output:"\u2A01", ttype:UNDEROVER},
{input:"\\bigotimes",	tag:"mo", output:"\u2A02", ttype:UNDEROVER},
{input:"\\bigodot",	tag:"mo", output:"\u2A00", ttype:UNDEROVER},
{input:"\\biguplus",	tag:"mo", output:"\u2A04", ttype:UNDEROVER},
{input:"\\int",		tag:"mo", output:"\u222B", ttype:CONST},
{input:"\\oint",	tag:"mo", output:"\u222E", ttype:CONST},

//binary relation symbols
{input:":=",		tag:"mo", output:":=",	   ttype:CONST},
{input:"\\lt",		tag:"mo", output:"<",	   ttype:CONST},
{input:"\\gt",		tag:"mo", output:">",	   ttype:CONST},
{input:"\\ne",		tag:"mo", output:"\u2260", ttype:CONST},
{input:"\\neq",		tag:"mo", output:"\u2260", ttype:CONST},
{input:"\\le",		tag:"mo", output:"\u2264", ttype:CONST},
{input:"\\leq",		tag:"mo", output:"\u2264", ttype:CONST},
{input:"\\leqslant",	tag:"mo", output:"\u2264", ttype:CONST},
{input:"\\ge",		tag:"mo", output:"\u2265", ttype:CONST},
{input:"\\geq",		tag:"mo", output:"\u2265", ttype:CONST},
{input:"\\geqslant",	tag:"mo", output:"\u2265", ttype:CONST},
{input:"\\equiv",	tag:"mo", output:"\u2261", ttype:CONST},
{input:"\\ll",		tag:"mo", output:"\u226A", ttype:CONST},
{input:"\\gg",		tag:"mo", output:"\u226B", ttype:CONST},
{input:"\\doteq",	tag:"mo", output:"\u2250", ttype:CONST},
{input:"\\prec",	tag:"mo", output:"\u227A", ttype:CONST},
{input:"\\succ",	tag:"mo", output:"\u227B", ttype:CONST},
{input:"\\preceq",	tag:"mo", output:"\u227C", ttype:CONST},
{input:"\\succeq",	tag:"mo", output:"\u227D", ttype:CONST},
{input:"\\subset",	tag:"mo", output:"\u2282", ttype:CONST},
{input:"\\supset",	tag:"mo", output:"\u2283", ttype:CONST},
{input:"\\subseteq",	tag:"mo", output:"\u2286", ttype:CONST},
{input:"\\supseteq",	tag:"mo", output:"\u2287", ttype:CONST},
{input:"\\sqsubset",	tag:"mo", output:"\u228F", ttype:CONST},
{input:"\\sqsupset",	tag:"mo", output:"\u2290", ttype:CONST},
{input:"\\sqsubseteq",  tag:"mo", output:"\u2291", ttype:CONST},
{input:"\\sqsupseteq",  tag:"mo", output:"\u2292", ttype:CONST},
{input:"\\sim",		tag:"mo", output:"\u223C", ttype:CONST},
{input:"\\simeq",	tag:"mo", output:"\u2243", ttype:CONST},
{input:"\\approx",	tag:"mo", output:"\u2248", ttype:CONST},
{input:"\\cong",	tag:"mo", output:"\u2245", ttype:CONST},
{input:"\\Join",	tag:"mo", output:"\u22C8", ttype:CONST},
{input:"\\bowtie",	tag:"mo", output:"\u22C8", ttype:CONST},
{input:"\\in",		tag:"mo", output:"\u2208", ttype:CONST},
{input:"\\ni",		tag:"mo", output:"\u220B", ttype:CONST},
{input:"\\owns",	tag:"mo", output:"\u220B", ttype:CONST},
{input:"\\propto",	tag:"mo", output:"\u221D", ttype:CONST},
{input:"\\vdash",	tag:"mo", output:"\u22A2", ttype:CONST},
{input:"\\dashv",	tag:"mo", output:"\u22A3", ttype:CONST},
{input:"\\models",	tag:"mo", output:"\u22A8", ttype:CONST},
{input:"\\perp",	tag:"mo", output:"\u22A5", ttype:CONST},
{input:"\\smile",	tag:"mo", output:"\u2323", ttype:CONST},
{input:"\\frown",	tag:"mo", output:"\u2322", ttype:CONST},
{input:"\\asymp",	tag:"mo", output:"\u224D", ttype:CONST},
{input:"\\notin",	tag:"mo", output:"\u2209", ttype:CONST},

//matrices
{input:"\\begin{eqnarray}",	output:"X",	ttype:MATRIX, invisible:true},
{input:"\\begin{array}",	output:"X",	ttype:MATRIX, invisible:true},
{input:"\\\\",			output:"}&{",	ttype:DEFINITION},
{input:"\\end{eqnarray}",	output:"}}",	ttype:DEFINITION},
{input:"\\end{array}",		output:"}}",	ttype:DEFINITION},

//grouping and literal brackets -- ieval is for IE
{input:"\\big",	   tag:"mo", output:"X", atval:"1.2", ieval:"2.2", ttype:BIG},
{input:"\\Big",	   tag:"mo", output:"X", atval:"1.6", ieval:"2.6", ttype:BIG},
{input:"\\bigg",   tag:"mo", output:"X", atval:"2.2", ieval:"3.2", ttype:BIG},
{input:"\\Bigg",   tag:"mo", output:"X", atval:"2.9", ieval:"3.9", ttype:BIG},
{input:"\\left",   tag:"mo", output:"X", ttype:LEFTBRACKET},
{input:"\\right",  tag:"mo", output:"X", ttype:RIGHTBRACKET},
{input:"{",	   output:"{", ttype:LEFTBRACKET,  invisible:true},
{input:"}",	   output:"}", ttype:RIGHTBRACKET, invisible:true},

{input:"(",	   tag:"mo", output:"(",      atval:"1", ttype:STRETCHY},
{input:"[",	   tag:"mo", output:"[",      atval:"1", ttype:STRETCHY},
{input:"\\lbrack", tag:"mo", output:"[",      atval:"1", ttype:STRETCHY},
{input:"\\{",	   tag:"mo", output:"{",      atval:"1", ttype:STRETCHY},
{input:"\\lbrace", tag:"mo", output:"{",      atval:"1", ttype:STRETCHY},
{input:"\\langle", tag:"mo", output:"\u2329", atval:"1", ttype:STRETCHY},
{input:"\\lfloor", tag:"mo", output:"\u230A", atval:"1", ttype:STRETCHY},
{input:"\\lceil",  tag:"mo", output:"\u2308", atval:"1", ttype:STRETCHY},

// rtag:"mi" causes space to be inserted before a following sin, cos, etc.
// (see function AMparseExpr() )
{input:")",	  tag:"mo",output:")",	    rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"]",	  tag:"mo",output:"]",	    rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"\\rbrack",tag:"mo",output:"]",	    rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"\\}",	  tag:"mo",output:"}",	    rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"\\rbrace",tag:"mo",output:"}",	    rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"\\rangle",tag:"mo",output:"\u232A", rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"\\rfloor",tag:"mo",output:"\u230B", rtag:"mi",atval:"1",ttype:STRETCHY},
{input:"\\rceil", tag:"mo",output:"\u2309", rtag:"mi",atval:"1",ttype:STRETCHY},

// "|", "\\|", "\\vert" and "\\Vert" modified later: lspace = rspace = 0em
{input:"|",		tag:"mo", output:"\u2223", atval:"1", ttype:STRETCHY},
{input:"\\|",		tag:"mo", output:"\u2225", atval:"1", ttype:STRETCHY},
{input:"\\vert",	tag:"mo", output:"\u2223", atval:"1", ttype:STRETCHY},
{input:"\\Vert",	tag:"mo", output:"\u2225", atval:"1", ttype:STRETCHY},
{input:"\\mid",		tag:"mo", output:"\u2223", atval:"1", ttype:STRETCHY},
{input:"\\parallel",	tag:"mo", output:"\u2225", atval:"1", ttype:STRETCHY},
{input:"/",		tag:"mo", output:"/",	atval:"1.01", ttype:STRETCHY},
{input:"\\backslash",	tag:"mo", output:"\u2216", atval:"1", ttype:STRETCHY},
{input:"\\setminus",	tag:"mo", output:"\\",	   ttype:CONST},

//miscellaneous symbols
{input:"\\!",	  tag:"mspace", atname:"width", atval:"-0.167em", ttype:SPACE},
{input:"\\,",	  tag:"mspace", atname:"width", atval:"0.167em", ttype:SPACE},
{input:"\\>",	  tag:"mspace", atname:"width", atval:"0.222em", ttype:SPACE},
{input:"\\:",	  tag:"mspace", atname:"width", atval:"0.222em", ttype:SPACE},
{input:"\\;",	  tag:"mspace", atname:"width", atval:"0.278em", ttype:SPACE},
{input:"~",	  tag:"mspace", atname:"width", atval:"0.333em", ttype:SPACE},
{input:"\\quad",  tag:"mspace", atname:"width", atval:"1em", ttype:SPACE},
{input:"\\qquad", tag:"mspace", atname:"width", atval:"2em", ttype:SPACE},
//{input:"{}",		  tag:"mo", output:"\u200B", ttype:CONST}, // zero-width
{input:"\\prime",	tag:"mo", output:"\u2032", ttype:CONST},
{input:"'",		tag:"mo", output:"\u02B9", ttype:CONST},
{input:"''",		tag:"mo", output:"\u02BA", ttype:CONST},
{input:"'''",		tag:"mo", output:"\u2034", ttype:CONST},
{input:"''''",		tag:"mo", output:"\u2057", ttype:CONST},
{input:"\\ldots",	tag:"mo", output:"\u2026", ttype:CONST},
{input:"\\cdots",	tag:"mo", output:"\u22EF", ttype:CONST},
{input:"\\vdots",	tag:"mo", output:"\u22EE", ttype:CONST},
{input:"\\ddots",	tag:"mo", output:"\u22F1", ttype:CONST},
{input:"\\forall",	tag:"mo", output:"\u2200", ttype:CONST},
{input:"\\exists",	tag:"mo", output:"\u2203", ttype:CONST},
{input:"\\Re",		tag:"mo", output:"\u211C", ttype:CONST},
{input:"\\Im",		tag:"mo", output:"\u2111", ttype:CONST},
{input:"\\aleph",	tag:"mo", output:"\u2135", ttype:CONST},
{input:"\\hbar",	tag:"mo", output:"\u210F", ttype:CONST},
{input:"\\ell",		tag:"mo", output:"\u2113", ttype:CONST},
{input:"\\wp",		tag:"mo", output:"\u2118", ttype:CONST},
{input:"\\emptyset",	tag:"mo", output:"\u2205", ttype:CONST},
{input:"\\infty",	tag:"mo", output:"\u221E", ttype:CONST},
{input:"\\surd",	tag:"mo", output:"\\sqrt{}", ttype:DEFINITION},
{input:"\\partial",	tag:"mo", output:"\u2202", ttype:CONST},
{input:"\\nabla",	tag:"mo", output:"\u2207", ttype:CONST},
{input:"\\triangle",	tag:"mo", output:"\u25B3", ttype:CONST},
{input:"\\therefore",	tag:"mo", output:"\u2234", ttype:CONST},
{input:"\\angle",	tag:"mo", output:"\u2220", ttype:CONST},
//{input:"\\\\ ",	  tag:"mo", output:"\u00A0", ttype:CONST},
{input:"\\diamond",	tag:"mo", output:"\u22C4", ttype:CONST},
//{input:"\\Diamond",	  tag:"mo", output:"\u25CA", ttype:CONST},
{input:"\\Diamond",	tag:"mo", output:"\u25C7", ttype:CONST},
{input:"\\neg",		tag:"mo", output:"\u00AC", ttype:CONST},
{input:"\\lnot",	tag:"mo", output:"\u00AC", ttype:CONST},
{input:"\\bot",		tag:"mo", output:"\u22A5", ttype:CONST},
{input:"\\top",		tag:"mo", output:"\u22A4", ttype:CONST},
{input:"\\square",	tag:"mo", output:"\u25AB", ttype:CONST},
{input:"\\Box",		tag:"mo", output:"\u25A1", ttype:CONST},
{input:"\\wr",		tag:"mo", output:"\u2240", ttype:CONST},

//standard functions
//Note UNDEROVER *must* have tag:"mo" to work properly
{input:"\\arccos", tag:"mi", output:"arccos", ttype:UNARY, func:true},
{input:"\\arcsin", tag:"mi", output:"arcsin", ttype:UNARY, func:true},
{input:"\\arctan", tag:"mi", output:"arctan", ttype:UNARY, func:true},
{input:"\\arg",	   tag:"mi", output:"arg",    ttype:UNARY, func:true},
{input:"\\cos",	   tag:"mi", output:"cos",    ttype:UNARY, func:true},
{input:"\\cosh",   tag:"mi", output:"cosh",   ttype:UNARY, func:true},
{input:"\\cot",	   tag:"mi", output:"cot",    ttype:UNARY, func:true},
{input:"\\coth",   tag:"mi", output:"coth",   ttype:UNARY, func:true},
{input:"\\csc",	   tag:"mi", output:"csc",    ttype:UNARY, func:true},
{input:"\\deg",	   tag:"mi", output:"deg",    ttype:UNARY, func:true},
{input:"\\det",	   tag:"mi", output:"det",    ttype:UNARY, func:true},
{input:"\\dim",	   tag:"mi", output:"dim",    ttype:UNARY, func:true}, //CONST?
{input:"\\exp",	   tag:"mi", output:"exp",    ttype:UNARY, func:true},
{input:"\\gcd",	   tag:"mi", output:"gcd",    ttype:UNARY, func:true}, //CONST?
{input:"\\hom",	   tag:"mi", output:"hom",    ttype:UNARY, func:true},
{input:"\\inf",	      tag:"mo", output:"inf",	 ttype:UNDEROVER},
{input:"\\ker",	   tag:"mi", output:"ker",    ttype:UNARY, func:true},
{input:"\\lg",	   tag:"mi", output:"lg",     ttype:UNARY, func:true},
{input:"\\lim",	      tag:"mo", output:"lim",	 ttype:UNDEROVER},
{input:"\\liminf",    tag:"mo", output:"liminf", ttype:UNDEROVER},
{input:"\\limsup",    tag:"mo", output:"limsup", ttype:UNDEROVER},
{input:"\\ln",	   tag:"mi", output:"ln",     ttype:UNARY, func:true},
{input:"\\log",	   tag:"mi", output:"log",    ttype:UNARY, func:true},
{input:"\\max",	      tag:"mo", output:"max",	 ttype:UNDEROVER},
{input:"\\min",	      tag:"mo", output:"min",	 ttype:UNDEROVER},
{input:"\\Pr",	   tag:"mi", output:"Pr",     ttype:UNARY, func:true},
{input:"\\sec",	   tag:"mi", output:"sec",    ttype:UNARY, func:true},
{input:"\\sin",	   tag:"mi", output:"sin",    ttype:UNARY, func:true},
{input:"\\sinh",   tag:"mi", output:"sinh",   ttype:UNARY, func:true},
{input:"\\sup",	      tag:"mo", output:"sup",	 ttype:UNDEROVER},
{input:"\\tan",	   tag:"mi", output:"tan",    ttype:UNARY, func:true},
{input:"\\tanh",   tag:"mi", output:"tanh",   ttype:UNARY, func:true},

//arrows
{input:"\\gets",		tag:"mo", output:"\u2190", ttype:CONST},
{input:"\\leftarrow",		tag:"mo", output:"\u2190", ttype:CONST},
{input:"\\to",			tag:"mo", output:"\u2192", ttype:CONST},
{input:"\\rightarrow",		tag:"mo", output:"\u2192", ttype:CONST},
{input:"\\leftrightarrow",	tag:"mo", output:"\u2194", ttype:CONST},
{input:"\\uparrow",		tag:"mo", output:"\u2191", ttype:CONST},
{input:"\\downarrow",		tag:"mo", output:"\u2193", ttype:CONST},
{input:"\\updownarrow",		tag:"mo", output:"\u2195", ttype:CONST},
{input:"\\Leftarrow",		tag:"mo", output:"\u21D0", ttype:CONST},
{input:"\\Rightarrow",		tag:"mo", output:"\u21D2", ttype:CONST},
{input:"\\Leftrightarrow",	tag:"mo", output:"\u21D4", ttype:CONST},
{input:"\\iff", tag:"mo", output:"~\\Longleftrightarrow~", ttype:DEFINITION},
{input:"\\Uparrow",		tag:"mo", output:"\u21D1", ttype:CONST},
{input:"\\Downarrow",		tag:"mo", output:"\u21D3", ttype:CONST},
{input:"\\Updownarrow",		tag:"mo", output:"\u21D5", ttype:CONST},
{input:"\\mapsto",		tag:"mo", output:"\u21A6", ttype:CONST},
{input:"\\longleftarrow",	tag:"mo", output:"\u2190", ttype:LONG},
{input:"\\longrightarrow",	tag:"mo", output:"\u2192", ttype:LONG},
{input:"\\longleftrightarrow",	tag:"mo", output:"\u2194", ttype:LONG},
{input:"\\Longleftarrow",	tag:"mo", output:"\u21D0", ttype:LONG},
{input:"\\Longrightarrow",	tag:"mo", output:"\u21D2", ttype:LONG},
{input:"\\Longleftrightarrow",  tag:"mo", output:"\u21D4", ttype:LONG},
{input:"\\longmapsto",		tag:"mo", output:"\u21A6", ttype:CONST},
							// disaster if LONG

//commands with argument
AMsqrt, AMroot, AMfrac, AMover, AMsub, AMsup, AMtext, AMmbox, AMatop, AMchoose,
//AMdiv, AMquote,

//diacritical marks
{input:"\\acute",	tag:"mover",  output:"\u00B4", ttype:UNARY, acc:true},
//{input:"\\acute",	  tag:"mover",  output:"\u0317", ttype:UNARY, acc:true},
//{input:"\\acute",	  tag:"mover",  output:"\u0301", ttype:UNARY, acc:true},
//{input:"\\grave",	  tag:"mover",  output:"\u0300", ttype:UNARY, acc:true},
//{input:"\\grave",	  tag:"mover",  output:"\u0316", ttype:UNARY, acc:true},
{input:"\\grave",	tag:"mover",  output:"\u0060", ttype:UNARY, acc:true},
{input:"\\breve",	tag:"mover",  output:"\u02D8", ttype:UNARY, acc:true},
{input:"\\check",	tag:"mover",  output:"\u02C7", ttype:UNARY, acc:true},
{input:"\\dot",		tag:"mover",  output:".",      ttype:UNARY, acc:true},
{input:"\\ddot",	tag:"mover",  output:"..",     ttype:UNARY, acc:true},
//{input:"\\ddot",	  tag:"mover",  output:"\u00A8", ttype:UNARY, acc:true},
{input:"\\mathring",	tag:"mover",  output:"\u00B0", ttype:UNARY, acc:true},
{input:"\\vec",		tag:"mover",  output:"\u20D7", ttype:UNARY, acc:true},
{input:"\\overrightarrow",tag:"mover",output:"\u20D7", ttype:UNARY, acc:true},
{input:"\\overleftarrow",tag:"mover", output:"\u20D6", ttype:UNARY, acc:true},
{input:"\\hat",		tag:"mover",  output:"\u005E", ttype:UNARY, acc:true},
{input:"\\widehat",	tag:"mover",  output:"\u0302", ttype:UNARY, acc:true},
{input:"\\tilde",	tag:"mover",  output:"~",      ttype:UNARY, acc:true},
//{input:"\\tilde",	  tag:"mover",  output:"\u0303", ttype:UNARY, acc:true},
{input:"\\widetilde",	tag:"mover",  output:"\u02DC", ttype:UNARY, acc:true},
{input:"\\bar",		tag:"mover",  output:"\u203E", ttype:UNARY, acc:true},
{input:"\\overbrace",	tag:"mover",  output:"\u23B4", ttype:UNARY, acc:true},
{input:"\\overline",	tag:"mover",  output:"\u00AF", ttype:UNARY, acc:true},
{input:"\\underbrace",  tag:"munder", output:"\u23B5", ttype:UNARY, acc:true},
{input:"\\underline",	tag:"munder", output:"\u00AF", ttype:UNARY, acc:true},
//{input:"underline",	tag:"munder", output:"\u0332", ttype:UNARY, acc:true},

//typestyles and fonts
{input:"\\displaystyle",tag:"mstyle",atname:"displaystyle",atval:"true", ttype:UNARY},
{input:"\\textstyle",tag:"mstyle",atname:"displaystyle",atval:"false", ttype:UNARY},
{input:"\\scriptstyle",tag:"mstyle",atname:"scriptlevel",atval:"1", ttype:UNARY},
{input:"\\scriptscriptstyle",tag:"mstyle",atname:"scriptlevel",atval:"2", ttype:UNARY},
{input:"\\textrm", tag:"mstyle", output:"\\mathrm", ttype: DEFINITION},
{input:"\\mathbf", tag:"mstyle", atname:"mathvariant", atval:"bold", ttype:UNARY},
{input:"\\textbf", tag:"mstyle", atname:"mathvariant", atval:"bold", ttype:UNARY},
{input:"\\mathit", tag:"mstyle", atname:"mathvariant", atval:"italic", ttype:UNARY},
{input:"\\textit", tag:"mstyle", atname:"mathvariant", atval:"italic", ttype:UNARY},
{input:"\\mathtt", tag:"mstyle", atname:"mathvariant", atval:"monospace", ttype:UNARY},
{input:"\\texttt", tag:"mstyle", atname:"mathvariant", atval:"monospace", ttype:UNARY},
{input:"\\mathsf", tag:"mstyle", atname:"mathvariant", atval:"sans-serif", ttype:UNARY},
{input:"\\mathbb", tag:"mstyle", atname:"mathvariant", atval:"double-struck", ttype:UNARY, codes:AMbbb},
{input:"\\mathcal",tag:"mstyle", atname:"mathvariant", atval:"script", ttype:UNARY, codes:AMcal},
{input:"\\mathfrak",tag:"mstyle",atname:"mathvariant", atval:"fraktur",ttype:UNARY, codes:AMfrk}
];

function compareNames(s1,s2) {
  if (s1.input > s2.input) return 1
  else return -1;
}

var AMnames = []; //list of input symbols

function AMinitSymbols() {
  AMsymbols.sort(compareNames);
  for (i=0; i<AMsymbols.length; i++) AMnames[i] = AMsymbols[i].input;
}

var AMmathml = "http://www.w3.org/1998/Math/MathML";

function AMcreateElementMathML(t) {
  if (isIE) return document.createElement("m:"+t);
  else return document.createElementNS(AMmathml,t);
}

function AMcreateMmlNode(t,frag) {
//  var node = AMcreateElementMathML(name);
  if (isIE) var node = document.createElement("m:"+t);
  else var node = document.createElementNS(AMmathml,t);
  node.appendChild(frag);
  return node;
}

function newcommand(oldstr,newstr) {
  AMsymbols = AMsymbols.concat([{input:oldstr, tag:"mo", output:newstr,
                                 ttype:DEFINITION}]);
}

function AMremoveCharsAndBlanks(str,n) {
//remove n characters and any following blanks
  var st;
  st = str.slice(n);
  for (var i=0; i<st.length && st.charCodeAt(i)<=32; i=i+1);
  return st.slice(i);
}

function AMposition(arr, str, n) {
// return position >=n where str appears or would be inserted
// assumes arr is sorted
  if (n==0) {
    var h,m;
    n = -1;
    h = arr.length;
    while (n+1<h) {
      m = (n+h) >> 1;
      if (arr[m]<str) n = m; else h = m;
    }
    return h;
  } else
    for (var i=n; i<arr.length && arr[i]<str; i++);
  return i; // i=arr.length || arr[i]>=str
}

function AMgetSymbol(str) {
//return maximal initial substring of str that appears in names
//return null if there is none
  var k = 0; //new pos
  var j = 0; //old pos
  var mk; //match pos
  var st;
  var tagst;
  var match = "";
  var more = true;
  for (var i=1; i<=str.length && more; i++) {
    st = str.slice(0,i); //initial substring of length i
    j = k;
    k = AMposition(AMnames, st, j);
    if (k<AMnames.length && str.slice(0,AMnames[k].length)==AMnames[k]){
      match = AMnames[k];
      mk = k;
      i = match.length;
    }
    more = k<AMnames.length && str.slice(0,AMnames[k].length)>=AMnames[k];
  }
  AMpreviousSymbol=AMcurrentSymbol;
  if (match!=""){
    AMcurrentSymbol=AMsymbols[mk].ttype;
    return AMsymbols[mk];
  }
  AMcurrentSymbol=CONST;
  k = 1;
  st = str.slice(0,1); //take 1 character
  if ("0"<=st && st<="9") tagst = "mn";
  else tagst = (("A">st || st>"Z") && ("a">st || st>"z")?"mo":"mi");
/*
// Commented out by DRW (not fully understood, but probably to do with
// use of "/" as an INFIX version of "\\frac", which we don't want):
//}
//if (st=="-" && AMpreviousSymbol==INFIX) {
//  AMcurrentSymbol = INFIX;  //trick "/" into recognizing "-" on second parse
//  return {input:st, tag:tagst, output:st, ttype:UNARY, func:true};
//}
*/
  return {input:st, tag:tagst, output:st, ttype:CONST};
}


/*Parsing ASCII math expressions with the following grammar
v ::= [A-Za-z] | greek letters | numbers | other constant symbols
u ::= sqrt | text | bb | other unary symbols for font commands
b ::= frac | root | stackrel	binary symbols
l ::= { | \left			left brackets
r ::= } | \right		right brackets
S ::= v | lEr | uS | bSS	Simple expression
I ::= S_S | S^S | S_S^S | S	Intermediate expression
E ::= IE | I/I			Expression
Each terminal symbol is translated into a corresponding mathml node.*/

var AMpreviousSymbol,AMcurrentSymbol;

function AMparseSexpr(str) { //parses str and returns [node,tailstr,(node)tag]
  var symbol, node, result, result2, i, st,// rightvert = false,
    newFrag = document.createDocumentFragment();
  str = AMremoveCharsAndBlanks(str,0);
  symbol = AMgetSymbol(str);             //either a token or a bracket or empty
  if (symbol == null || symbol.ttype == RIGHTBRACKET)
    return [null,str,null];
  if (symbol.ttype == DEFINITION) {
    str = symbol.output+AMremoveCharsAndBlanks(str,symbol.input.length);
    symbol = AMgetSymbol(str);
    if (symbol == null || symbol.ttype == RIGHTBRACKET)
      return [null,str,null];
  }
  str = AMremoveCharsAndBlanks(str,symbol.input.length);
  switch (symbol.ttype) {
  case SPACE:
    node = AMcreateElementMathML(symbol.tag);
    node.setAttribute(symbol.atname,symbol.atval);
    return [node,str,symbol.tag];
  case UNDEROVER:
    if (isIE) {
      if (symbol.input.substr(0,4) == "\\big") {   // botch for missing symbols
	str = "\\"+symbol.input.substr(4)+str;	   // make \bigcup = \cup etc.
	symbol = AMgetSymbol(str);
	symbol.ttype = UNDEROVER;
	str = AMremoveCharsAndBlanks(str,symbol.input.length);
      }
    }
    return [AMcreateMmlNode(symbol.tag,
			document.createTextNode(symbol.output)),str,symbol.tag];
  case CONST:
    var output = symbol.output;
    if (isIE) {
      if (symbol.input == "'")
	output = "\u2032";
      else if (symbol.input == "''")
	output = "\u2033";
      else if (symbol.input == "'''")
	output = "\u2033\u2032";
      else if (symbol.input == "''''")
	output = "\u2033\u2033";
      else if (symbol.input == "\\square")
	output = "\u25A1";	// same as \Box
      else if (symbol.input.substr(0,5) == "\\frac") {
						// botch for missing fractions
	var denom = symbol.input.substr(6,1);
	if (denom == "5" || denom == "6") {
	  str = symbol.input.replace(/\\frac/,"\\frac ")+str;
	  return [node,str,symbol.tag];
	}
      }
    }
    node = AMcreateMmlNode(symbol.tag,document.createTextNode(output));
    return [node,str,symbol.tag];
  case LONG:  // added by DRW
    node = AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));
    node.setAttribute("minsize","1.5");
    node.setAttribute("maxsize","1.5");
    node = AMcreateMmlNode("mover",node);
    node.appendChild(AMcreateElementMathML("mspace"));
    return [node,str,symbol.tag];
  case STRETCHY:  // added by DRW
    if (isIE && symbol.input == "\\backslash")
	symbol.output = "\\";	// doesn't expand, but then nor does "\u2216"
    node = AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));
    if (symbol.input == "|" || symbol.input == "\\vert" ||
	symbol.input == "\\|" || symbol.input == "\\Vert") {
	  node.setAttribute("lspace","0em");
	  node.setAttribute("rspace","0em");
    }
    node.setAttribute("maxsize",symbol.atval);  // don't allow to stretch here
    if (symbol.rtag != null)
      return [node,str,symbol.rtag];
    else
      return [node,str,symbol.tag];
  case BIG:  // added by DRW
    var atval = symbol.atval;
    if (isIE)
      atval = symbol.ieval;
    symbol = AMgetSymbol(str);
    if (symbol == null)
	return [null,str,null];
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    node = AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output));
    if (isIE) {		// to get brackets to expand
      var space = AMcreateElementMathML("mspace");
      space.setAttribute("height",atval+"ex");
      node = AMcreateMmlNode("mrow",node);
      node.appendChild(space);
    } else {		// ignored in IE
      node.setAttribute("minsize",atval);
      node.setAttribute("maxsize",atval);
    }
    return [node,str,symbol.tag];
  case LEFTBRACKET:   //read (expr+)
    if (symbol.input == "\\left") { // left what?
      symbol = AMgetSymbol(str);
      if (symbol != null) {
	if (symbol.input == ".")
	  symbol.invisible = true;
	str = AMremoveCharsAndBlanks(str,symbol.input.length);
      }
    }
    result = AMparseExpr(str,true,false);
    if (symbol==null ||
	(typeof symbol.invisible == "boolean" && symbol.invisible))
      node = AMcreateMmlNode("mrow",result[0]);
    else {
      node = AMcreateMmlNode("mo",document.createTextNode(symbol.output));
      node = AMcreateMmlNode("mrow",node);
      node.appendChild(result[0]);
    }
    return [node,result[1],result[2]];
  case MATRIX:	 //read (expr+)
    if (symbol.input == "\\begin{array}") {
      var mask = "";
      symbol = AMgetSymbol(str);
      str = AMremoveCharsAndBlanks(str,0);
      if (symbol == null)
	mask = "l";
      else {
	str = AMremoveCharsAndBlanks(str,symbol.input.length);
	if (symbol.input != "{")
	  mask = "l";
	else do {
	  symbol = AMgetSymbol(str);
	  if (symbol != null) {
	    str = AMremoveCharsAndBlanks(str,symbol.input.length);
	    if (symbol.input != "}")
	      mask = mask+symbol.input;
	  }
	} while (symbol != null && symbol.input != "" && symbol.input != "}");
      }
      result = AMparseExpr("{"+str,true,true);
//    if (result[0]==null) return [AMcreateMmlNode("mo",
//			   document.createTextNode(symbol.input)),str];
      node = AMcreateMmlNode("mtable",result[0]);
      mask = mask.replace(/l/g,"left ");
      mask = mask.replace(/r/g,"right ");
      mask = mask.replace(/c/g,"center ");
      node.setAttribute("columnalign",mask);
      node.setAttribute("displaystyle","false");
      if (isIE)
	return [node,result[1],null];
// trying to get a *little* bit of space around the array
// (IE already includes it)
      var lspace = AMcreateElementMathML("mspace");
      lspace.setAttribute("width","0.167em");
      var rspace = AMcreateElementMathML("mspace");
      rspace.setAttribute("width","0.167em");
      var node1 = AMcreateMmlNode("mrow",lspace);
      node1.appendChild(node);
      node1.appendChild(rspace);
      return [node1,result[1],null];
    } else {	// eqnarray
      result = AMparseExpr("{"+str,true,true);
      node = AMcreateMmlNode("mtable",result[0]);
      if (isIE)
	node.setAttribute("columnspacing","0.25em"); // best in practice?
      else
	node.setAttribute("columnspacing","0.167em"); // correct (but ignored?)
      node.setAttribute("columnalign","right center left");
      node.setAttribute("displaystyle","true");
      node = AMcreateMmlNode("mrow",node);
      return [node,result[1],null];
    }
  case TEXT:
      if (str.charAt(0)=="{") i=str.indexOf("}");
      else i = 0;
      if (i==-1)
		 i = str.length;
      st = str.slice(1,i);
      if (st.charAt(0) == " ") {
	node = AMcreateElementMathML("mspace");
	node.setAttribute("width","0.33em");	// was 1ex
	newFrag.appendChild(node);
      }
      newFrag.appendChild(
        AMcreateMmlNode(symbol.tag,document.createTextNode(st)));
      if (st.charAt(st.length-1) == " ") {
	node = AMcreateElementMathML("mspace");
	node.setAttribute("width","0.33em");	// was 1ex
	newFrag.appendChild(node);
      }
      str = AMremoveCharsAndBlanks(str,i+1);
      return [AMcreateMmlNode("mrow",newFrag),str,null];
  case UNARY:
      result = AMparseSexpr(str);
      if (result[0]==null) return [AMcreateMmlNode(symbol.tag,
                             document.createTextNode(symbol.output)),str];
      if (typeof symbol.func == "boolean" && symbol.func) { // functions hack
	st = str.charAt(0);
//	if (st=="^" || st=="_" || st=="/" || st=="|" || st==",") {
	if (st=="^" || st=="_" || st==",") {
	  return [AMcreateMmlNode(symbol.tag,
		    document.createTextNode(symbol.output)),str,symbol.tag];
        } else {
	  node = AMcreateMmlNode("mrow",
	   AMcreateMmlNode(symbol.tag,document.createTextNode(symbol.output)));
	  if (isIE) {
	    var space = AMcreateElementMathML("mspace");
	    space.setAttribute("width","0.167em");
	    node.appendChild(space);
	  }
	  node.appendChild(result[0]);
	  return [node,result[1],symbol.tag];
        }
      }
      if (symbol.input == "\\sqrt") {		// sqrt
	if (isIE) {	// set minsize, for \surd
	  var space = AMcreateElementMathML("mspace");
	  space.setAttribute("height","1.2ex");
	  space.setAttribute("width","0em");	// probably no effect
	  node = AMcreateMmlNode(symbol.tag,result[0])
//	  node.setAttribute("minsize","1");	// ignored
//	  node = AMcreateMmlNode("mrow",node);  // hopefully unnecessary
	  node.appendChild(space);
	  return [node,result[1],symbol.tag];
	} else
	  return [AMcreateMmlNode(symbol.tag,result[0]),result[1],symbol.tag];
      } else if (typeof symbol.acc == "boolean" && symbol.acc) {   // accent
        node = AMcreateMmlNode(symbol.tag,result[0]);
	var output = symbol.output;
	if (isIE) {
		if (symbol.input == "\\hat")
			output = "\u0302";
		else if (symbol.input == "\\widehat")
			output = "\u005E";
		else if (symbol.input == "\\bar")
			output = "\u00AF";
		else if (symbol.input == "\\grave")
			output = "\u0300";
		else if (symbol.input == "\\tilde")
			output = "\u0303";
	}
	var node1 = AMcreateMmlNode("mo",document.createTextNode(output));
	if (symbol.input == "\\vec" || symbol.input == "\\check")
						// don't allow to stretch
	    node1.setAttribute("maxsize","1.2");
		 // why doesn't "1" work?  \vec nearly disappears in firefox
	if (isIE && symbol.input == "\\bar")
	    node1.setAttribute("maxsize","0.5");
	if (symbol.input == "\\underbrace" || symbol.input == "\\underline")
	  node1.setAttribute("accentunder","true");
	else
	  node1.setAttribute("accent","true");
	node.appendChild(node1);
	if (symbol.input == "\\overbrace" || symbol.input == "\\underbrace")
	  node.ttype = UNDEROVER;
	return [node,result[1],symbol.tag];
      } else {			      // font change or displaystyle command
        if (!isIE && typeof symbol.codes != "undefined") {
          for (i=0; i<result[0].childNodes.length; i++)
            if (result[0].childNodes[i].nodeName=="mi" || result[0].nodeName=="mi") {
              st = (result[0].nodeName=="mi"?result[0].firstChild.nodeValue:
                              result[0].childNodes[i].firstChild.nodeValue);
              var newst = [];
              for (var j=0; j<st.length; j++)
                if (st.charCodeAt(j)>64 && st.charCodeAt(j)<91) newst = newst +
                  String.fromCharCode(symbol.codes[st.charCodeAt(j)-65]);
                else newst = newst + st.charAt(j);
              if (result[0].nodeName=="mi")
                result[0]=AMcreateElementMathML("mo").
                          appendChild(document.createTextNode(newst));
              else result[0].replaceChild(AMcreateElementMathML("mo").
          appendChild(document.createTextNode(newst)),result[0].childNodes[i]);
            }
        }
        node = AMcreateMmlNode(symbol.tag,result[0]);
        node.setAttribute(symbol.atname,symbol.atval);
	if (symbol.input == "\\scriptstyle" ||
	    symbol.input == "\\scriptscriptstyle")
		node.setAttribute("displaystyle","false");
	return [node,result[1],symbol.tag];
      }
  case BINARY:
    result = AMparseSexpr(str);
    if (result[0]==null) return [AMcreateMmlNode("mo",
			   document.createTextNode(symbol.input)),str,null];
    result2 = AMparseSexpr(result[1]);
    if (result2[0]==null) return [AMcreateMmlNode("mo",
			   document.createTextNode(symbol.input)),str,null];
    if (symbol.input=="\\root" || symbol.input=="\\stackrel")
      newFrag.appendChild(result2[0]);
    newFrag.appendChild(result[0]);
    if (symbol.input=="\\frac") newFrag.appendChild(result2[0]);
    return [AMcreateMmlNode(symbol.tag,newFrag),result2[1],symbol.tag];
  case INFIX:
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    return [AMcreateMmlNode("mo",document.createTextNode(symbol.output)),
	str,symbol.tag];
  default:
    return [AMcreateMmlNode(symbol.tag,        //its a constant
	document.createTextNode(symbol.output)),str,symbol.tag];
  }
}

function AMparseIexpr(str) {
  var symbol, sym1, sym2, node, result, tag, underover;
  str = AMremoveCharsAndBlanks(str,0);
  sym1 = AMgetSymbol(str);
  result = AMparseSexpr(str);
  node = result[0];
  str = result[1];
  tag = result[2];
  symbol = AMgetSymbol(str);
  if (symbol.ttype == INFIX) {
    str = AMremoveCharsAndBlanks(str,symbol.input.length);
    result = AMparseSexpr(str);
    if (result[0] == null) // show box in place of missing argument
      result[0] = AMcreateMmlNode("mo",document.createTextNode("\u25A1"));
    str = result[1];
    tag = result[2];
    if (symbol.input == "_" || symbol.input == "^") {
      sym2 = AMgetSymbol(str);
      tag = null;	// no space between x^2 and a following sin, cos, etc.
// This is for \underbrace and \overbrace
      underover = ((sym1.ttype == UNDEROVER) || (node.ttype == UNDEROVER));
//    underover = (sym1.ttype == UNDEROVER);
      if (symbol.input == "_" && sym2.input == "^") {
        str = AMremoveCharsAndBlanks(str,sym2.input.length);
        var res2 = AMparseSexpr(str);
	str = res2[1];
	tag = res2[2];  // leave space between x_1^2 and a following sin etc.
        node = AMcreateMmlNode((underover?"munderover":"msubsup"),node);
        node.appendChild(result[0]);
        node.appendChild(res2[0]);
      } else if (symbol.input == "_") {
	node = AMcreateMmlNode((underover?"munder":"msub"),node);
        node.appendChild(result[0]);
      } else {
	node = AMcreateMmlNode((underover?"mover":"msup"),node);
        node.appendChild(result[0]);
      }
      node = AMcreateMmlNode("mrow",node); // so sum does not stretch
    } else {
      node = AMcreateMmlNode(symbol.tag,node);
      if (symbol.input == "\\atop" || symbol.input == "\\choose")
	node.setAttribute("linethickness","0ex");
      node.appendChild(result[0]);
      if (symbol.input == "\\choose")
	node = AMcreateMmlNode("mfenced",node);
    }
  }
  return [node,str,tag];
}

function AMparseExpr(str,rightbracket,matrix) {
  var symbol, node, result, i, tag,
  newFrag = document.createDocumentFragment();
  do {
    str = AMremoveCharsAndBlanks(str,0);
    result = AMparseIexpr(str);
    node = result[0];
    str = result[1];
    tag = result[2];
    symbol = AMgetSymbol(str);
    if (node!=undefined) {
      if ((tag == "mn" || tag == "mi") && symbol!=null &&
	typeof symbol.func == "boolean" && symbol.func) {
			// Add space before \sin in 2\sin x or x\sin x
	  var space = AMcreateElementMathML("mspace");
	  space.setAttribute("width","0.167em");
	  node = AMcreateMmlNode("mrow",node);
	  node.appendChild(space);
      }
      newFrag.appendChild(node);
    }
  } while ((symbol.ttype != RIGHTBRACKET)
        && symbol!=null && symbol.output!="");
  tag = null;
  if (symbol.ttype == RIGHTBRACKET) {
    if (symbol.input == "\\right") { // right what?
      str = AMremoveCharsAndBlanks(str,symbol.input.length);
      symbol = AMgetSymbol(str);
      if (symbol != null && symbol.input == ".")
	symbol.invisible = true;
      if (symbol != null)
	tag = symbol.rtag;
    }
    if (symbol!=null)
      str = AMremoveCharsAndBlanks(str,symbol.input.length); // ready to return
    var len = newFrag.childNodes.length;
    if (matrix &&
      len>0 && newFrag.childNodes[len-1].nodeName == "mrow" && len>1 &&
      newFrag.childNodes[len-2].nodeName == "mo" &&
      newFrag.childNodes[len-2].firstChild.nodeValue == "&") { //matrix
	var pos = []; // positions of ampersands
        var m = newFrag.childNodes.length;
        for (i=0; matrix && i<m; i=i+2) {
          pos[i] = [];
          node = newFrag.childNodes[i];
	  for (var j=0; j<node.childNodes.length; j++)
	    if (node.childNodes[j].firstChild.nodeValue=="&")
	      pos[i][pos[i].length]=j;
        }
	var row, frag, n, k, table = document.createDocumentFragment();
	for (i=0; i<m; i=i+2) {
	  row = document.createDocumentFragment();
	  frag = document.createDocumentFragment();
	  node = newFrag.firstChild; // <mrow> -&-&...&-&- </mrow>
	  n = node.childNodes.length;
	  k = 0;
	  for (j=0; j<n; j++) {
	    if (typeof pos[i][k] != "undefined" && j==pos[i][k]){
	      node.removeChild(node.firstChild); //remove &
	      row.appendChild(AMcreateMmlNode("mtd",frag));
	      k++;
	    } else frag.appendChild(node.firstChild);
	  }
	  row.appendChild(AMcreateMmlNode("mtd",frag));
	  if (newFrag.childNodes.length>2) {
	    newFrag.removeChild(newFrag.firstChild); //remove <mrow> </mrow>
	    newFrag.removeChild(newFrag.firstChild); //remove <mo>&</mo>
	  }
	  table.appendChild(AMcreateMmlNode("mtr",row));
	}
	return [table,str];
    }
    if (typeof symbol.invisible != "boolean" || !symbol.invisible) {
      node = AMcreateMmlNode("mo",document.createTextNode(symbol.output));
      newFrag.appendChild(node);
    }
  }
  return [newFrag,str,tag];
}

function AMparseMath(str) {
  var result, node = AMcreateElementMathML("mstyle");
  if (mathcolor != "") node.setAttribute("mathcolor",mathcolor);
  if (mathfontfamily != "") node.setAttribute("fontfamily",mathfontfamily);
  node.appendChild(AMparseExpr(str.replace(/^\s+/g,""),false,false)[0]);
  node = AMcreateMmlNode("math",node);
  if (showasciiformulaonhover)                      //fixed by djhsu so newline
    node.setAttribute("title",str.replace(/\s+/g," "));//does not show in Gecko
  if (mathfontfamily != "" && (isIE || mathfontfamily != "serif")) {
    var fnode = AMcreateElementXHTML("font");
    fnode.setAttribute("face",mathfontfamily);
    fnode.appendChild(node);
    return fnode;
  }
  return node;
}

function AMstrarr2docFrag(arr, linebreaks) {
  var newFrag=document.createDocumentFragment();
  var expr = false;
  for (var i=0; i<arr.length; i++) {
    if (expr) newFrag.appendChild(AMparseMath(arr[i]));
    else {
      var arri = (linebreaks ? arr[i].split("\n\n") : [arr[i]]);
      newFrag.appendChild(AMcreateElementXHTML("span").
      appendChild(document.createTextNode(arri[0])));
      for (var j=1; j<arri.length; j++) {
        newFrag.appendChild(AMcreateElementXHTML("p"));
        newFrag.appendChild(AMcreateElementXHTML("span").
        appendChild(document.createTextNode(arri[j])));
      }
    }
    expr = !expr;
  }
  return newFrag;
}

function AMprocessNodeR(n, linebreaks) {
  var mtch, str, arr, frg, i;
  if (n.childNodes.length == 0) {
   if ((n.nodeType!=8 || linebreaks) &&
    n.parentNode.nodeName!="form" && n.parentNode.nodeName!="FORM" &&
    n.parentNode.nodeName!="textarea" && n.parentNode.nodeName!="TEXTAREA" &&
    n.parentNode.nodeName!="pre" && n.parentNode.nodeName!="PRE") {
    str = n.nodeValue;
    if (!(str == null)) {
      str = str.replace(/\r\n\r\n/g,"\n\n");
      str = str.replace(/\x20+/g," ");
      str = str.replace(/\s*\r\n/g," ");
// DELIMITERS:
      mtch = (str.indexOf("\$")==-1 ? false : true);
      str = str.replace(/([^\\])\$/g,"$1 \$");
      str = str.replace(/^\$/," \$");	// in case \$ at start of string
      arr = str.split(" \$");
      for (i=0; i<arr.length; i++)
	arr[i]=arr[i].replace(/\\\$/g,"\$");
      if (arr.length>1 || mtch) {
        if (checkForMathML) {
          checkForMathML = false;
          var nd = AMisMathMLavailable();
          AMnoMathML = nd != null;
          if (AMnoMathML && notifyIfNoMathML)
            if (alertIfNoMathML)
              alert("To view the ASCIIMathML notation use Internet Explorer 6 +\nMathPlayer (free from www.dessci.com)\n\
                or Firefox/Mozilla/Netscape");
            else AMbody.insertBefore(nd,AMbody.childNodes[0]);
        }
        if (!AMnoMathML) {
          frg = AMstrarr2docFrag(arr,n.nodeType==8);
          var len = frg.childNodes.length;
          n.parentNode.replaceChild(frg,n);
          return len-1;
        } else return 0;
      }
    }
   } else return 0;
  } else if (n.nodeName!="math") {
    for (i=0; i<n.childNodes.length; i++)
      i += AMprocessNodeR(n.childNodes[i], linebreaks);
  }
  return 0;
}

function AMprocessNode(n, linebreaks, spanclassAM) {
  var frag,st;
  if (spanclassAM!=null) {
    frag = document.getElementsByTagName("span")
    for (var i=0;i<frag.length;i++)
      if (frag[i].className == "AM")
        AMprocessNodeR(frag[i],linebreaks);
  } else {
    try {
      st = n.innerHTML;
    } catch(err) {}
// DELIMITERS:
    if (st==null || st.indexOf("\$")!=-1)
      AMprocessNodeR(n,linebreaks);
  }
  if (isIE) { //needed to match size and font of formula to surrounding text
    frag = document.getElementsByTagName('math');
    for (var i=0;i<frag.length;i++) frag[i].update()
  }
}

var AMbody;
var AMnoMathML = false, AMtranslated = false;

function translate(spanclassAM) {
  if (!AMtranslated) { // run this only once
    AMtranslated = true;
    AMinitSymbols();
    AMbody = document.getElementsByTagName("body")[0];
    AMprocessNode(AMbody, false, spanclassAM);
  }
}

if (isIE) { // avoid adding MathPlayer info explicitly to each webpage
  document.write("<object id=\"mathplayer\"\
  classid=\"clsid:32F66A20-7614-11D4-BD11-00104BD3F987\"></object>");
  document.write("<?import namespace=\"m\" implementation=\"#mathplayer\"?>");
}

// GO1.1 Generic onload by Brothercake
// http://www.brothercake.com/
//onload function (replaces the onload="translate()" in the <body> tag)
function generic()
{
  translate();
};
//setup onload function
if(typeof window.addEventListener != 'undefined')
{
  //.. gecko, safari, konqueror and standard
  window.addEventListener('load', generic, false);
}
else if(typeof document.addEventListener != 'undefined')
{
  //.. opera 7
  document.addEventListener('load', generic, false);
}
else if(typeof window.attachEvent != 'undefined')
{
  //.. win/ie
  window.attachEvent('onload', generic);
}
//** remove this condition to degrade older browsers
else
{
  //.. mac/ie5 and anything else that gets this far
  //if there's an existing onload function
  if(typeof window.onload == 'function')
  {
    //store it
    var existing = onload;
    //add new onload handler
    window.onload = function()
    {
      //call existing onload function
      existing();
      //call generic onload function
      generic();
    };
  }
  else
  {
    //setup onload function
    window.onload = generic;
  }
}
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_introdução_à_plataforma_de_simulação_robótica_v_rep">Introdução à plataforma de simulação robótica V-rep</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/introducao_vrep.png" alt="imagens/introducao_vrep.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>V-rep (virtual robot experimentation plattform) é um simulador robótico de propósito geral com um ambiente de desenvolvimento integrado. Sensores, mecanismos, robôs e sistemas completos podem ser modelados e simulados utilizando o v-rep.</p></div>
<div class="paragraph"><p>Algumas possíveis aplicações:</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Rápida prototipagem e verificação
</p>
</li>
<li>
<p>
Robótica educacional
</p>
</li>
<li>
<p>
Monitoramento remoto
</p>
</li>
<li>
<p>
Controle de hardware
</p>
</li>
<li>
<p>
etc.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Possui APIs em 7 linguagens de programação: C/C++, Python, Java, Lua, Matlab, Octave or Urbi.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/apis.png" alt="imagens/apis.png" width="300" height="250">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_elementos_centrais_do_v_rep">Elementos centrais do V-rep</h2>
<div class="sectionbody">
<div class="paragraph"><p>O V-rep possui 3 elementos centrais:</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Objetos de cena
</p>
</li>
<li>
<p>
Módulo de cálculo
</p>
</li>
<li>
<p>
Mecanismos de controle
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_objetos_de_cena">Objetos de cena</h3>
<div class="paragraph"><p>São os blocos básicos disponibilizados pelo V-rep para a construção de um projeto.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/objetosdecena.png" alt="imagens/objetosdecena.png" width="450" height="350">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_módulo_de_cálculo">Módulo de cálculo</h3>
<div class="paragraph"><p>Possui:</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Detecção de colisão
</p>
</li>
<li>
<p>
Cálculo da distância mínima
</p>
</li>
<li>
<p>
Cinemática direta e inversa
</p>
</li>
<li>
<p>
Planejamento de caminho e movimento
</p>
</li>
<li>
<p>
Física / Dinâmica
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/modulodecalculo.png" alt="imagens/modulodecalculo.png" width="500" height="350">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_mecanismos_de_controle">Mecanismos de controle</h3>
<div class="paragraph"><p>Possui 6 interfaces de controle:</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Scripts embarcados
</p>
</li>
<li>
<p>
Plugins
</p>
</li>
<li>
<p>
Add-ons
</p>
</li>
<li>
<p>
Nós ROS
</p>
</li>
<li>
<p>
Soluções customizadas
</p>
</li>
<li>
<p>
API remota
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/meccontrole.png" alt="imagens/meccontrole.png" width="400" height="350">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_download_e_instalação">Download e instalação</h2>
<div class="sectionbody">
<div class="paragraph"><p>O processo de download e instalação do V-rep é bem simples: basta clicar no link <a href="http://www.coppeliarobotics.com/downloads.html">download vrep</a> e selecionar a opção de download adequada. Para nossos propósitos, utilizaremos a versão V-rep pro edu.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/download.png" alt="imagens/download.png" width="450" height="150">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interface_principal_do_v_rep">Interface principal do V-rep</h2>
<div class="sectionbody">
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/maininterface.png" alt="imagens/maininterface.png" width="700" height="550">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_formas_de_modelar_um_robô_no_v_rep">﻿Formas de modelar um robô no v-rep</h2>
<div class="sectionbody">
<div class="paragraph"><p>Basicamente existem duas formas de modelar os robôs:</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Modelagem utilizando elemento básicos;
</p>
</li>
<li>
<p>
Modelagem utilizando CAD.
</p>
</li>
</ul></div>
<div class="paragraph"><p>A imagem destaca os elementos básicos como plano, circulo, esféra, cubo e cilinndro.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ModelagemBasica.png" alt="imagens/ModelagemBasica.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Já em CAD, o usuário é responsáveis por projetar cada peça.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/modelagem.png" alt="imagens/modelagem.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Além dos elementos estruturais, já citados, pode-se ainda destacar elementos alguns outros utilizados, como Juntas, Sensores, Dummy, câmera, gráficos, luz e espelho, .</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ModelagemBasicaJuntas.png" alt="imagens/ModelagemBasicaJuntas.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ModelagemBasicaSensores.png" alt="imagens/ModelagemBasicaSensores.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Como pode-se observar, existem três tipo de juntas, a rotacional, prismática e esférica. Cada uma com suas particularidades.</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Rotacional: Rotaciona apenas em eixo;
</p>
</li>
<li>
<p>
Primática: Realiza uma translação em um eixo;
</p>
</li>
<li>
<p>
Esférica: Rotacional nos três eixos.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Outro ponto é a possibilidade de utilizar vários tipos de sensores:</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Força;
</p>
</li>
<li>
<p>
Proximidade;
</p>
</li>
<li>
<p>
Visão;
</p>
</li>
<li>
<p>
Laser;
</p>
</li>
<li>
<p>
etc.
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_parâmetros_dos_possíveis_objetos_de_cena">Parâmetros dos possíveis objetos de cena</h3>
<div class="ulist compact"><ul>
<li>
<p>
Câmera;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/cameraProperties1.jpg" alt="imagens/cameraProperties1.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Dummy;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/dummyDialog1.jpg" alt="imagens/dummyDialog1.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Sensor de força;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/forceSensorDialog1.jpg" alt="imagens/forceSensorDialog1.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Gráficos;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/graphDialog1.jpg" alt="imagens/graphDialog1.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Juntas;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/jointDialog1.jpg" alt="imagens/jointDialog1.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Luz;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/lightProperties1.jpg" alt="imagens/lightProperties1.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Espelho;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/mirrorDialog1.jpg" alt="imagens/mirrorDialog1.jpg" width="300" height="250">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_como_utilizar_cada_componente">Como Utilizar cada componente</h3>
<div class="ulist compact"><ul>
<li>
<p>
Adicionar Objetos a cena (Add);
</p>
<div class="ulist"><ul>
<li>
<p>
Clicar em "Add" e escolher que componente se deseja adicionar.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Dimensões;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/geometryDialog.jpg" alt="imagens/geometryDialog.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Parâmetros de posicionamento e orientação;
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/orientationAndRotationDlg.jpg" alt="imagens/orientationAndRotationDlg.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Parâmetros comuns.
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/objectCommonDlg2.jpg" alt="imagens/objectCommonDlg2.jpg" width="300" height="250">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uso_das_funções_de_grouping_merging">Uso das funções de Grouping/Merging</h3>
<div class="ulist compact"><ul>
<li>
<p>
Grouping;
</p>
<div class="ulist"><ul>
<li>
<p>
Agrupar um conjunto de objetos. Dessa forma é possível manipulá-los como um só.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Merging;
</p>
<div class="ulist"><ul>
<li>
<p>
De forma análoga ao Grouping, mas nesse modo objetos são deslocados para o referencial do primeiro obejto.
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_modelando_o_primeiro_objeto">Modelando o primeiro objeto</h3>
<div class="ulist compact"><ul>
<li>
<p>
O modelo Phantom Omni foi escolhi como referência para a modelagem.
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/LargePHANTOMOmniImage.jpg" alt="imagens/LargePHANTOMOmniImage.jpg" width="300" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Vídeo: <a href="https://www.youtube.com/watch?v=REA97hRX0WQ">https://www.youtube.com/watch?v=REA97hRX0WQ</a>
</p>
</li>
<li>
<p>
Esse modelo possui três juntas rotacionais e três elos como componentes principais.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Assim pode-se então começar o desenvolvimento a partir da base que servirá como sustentação para o nosso modelo.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parabase.png" alt="imagens/Parabase.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParabaseOrientacao.png" alt="imagens/ParabaseOrientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParabasePosicao.png" alt="imagens/ParabasePosicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Precisamos agora inserir a primeira junta que será responsável pela rotação da base.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaJunta1.png" alt="imagens/ParaJunta1.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parajunta1Orientacao.png" alt="imagens/Parajunta1Orientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parajunta1Posicao.png" alt="imagens/Parajunta1Posicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Após a definição da junta 1 se define o Elo 1.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo1.png" alt="imagens/ParaElo1.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo1Orientacao.png" alt="imagens/ParaElo1Orientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo1Posicao.png" alt="imagens/ParaElo1Posicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>De forma análoga aos demais elementos foram construídos os outros componentes.</p></div>
<div class="paragraph"><p>Junta 2:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaJunta2.png" alt="imagens/ParaJunta2.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parajunta2Orientacao.png" alt="imagens/Parajunta2Orientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parajunta2Posicao.png" alt="imagens/Parajunta2Posicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Elo 2:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo2.png" alt="imagens/ParaElo2.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo2Orientacao.png" alt="imagens/ParaElo2Orientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo2Posicao.png" alt="imagens/ParaElo2Posicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Junta 3:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaJunta3.png" alt="imagens/ParaJunta3.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parajunta3Orientacao.png" alt="imagens/Parajunta3Orientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Parajunta3Posicao.png" alt="imagens/Parajunta3Posicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Elo 3:</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo3.png" alt="imagens/ParaElo3.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo3Orientacao.png" alt="imagens/ParaElo3Orientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParaElo3Posicao.png" alt="imagens/ParaElo3Posicao.png" width="300" height="250">
</div>
</div>
<div class="paragraph"><p>Garra :</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/Paragarra.png" alt="imagens/Paragarra.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParagarraOrientacao.png" alt="imagens/ParagarraOrientacao.png" width="300" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ParagarraPosicao.png" alt="imagens/ParagarraPosicao.png" width="300" height="250">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_simulação">Simulação</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_parâmetros_da_simulação">Parâmetros da simulação</h3>
<div class="ulist compact"><ul>
<li>
<p>
Velocidade;
</p>
</li>
<li>
<p>
Tempo amostral;
</p>
</li>
<li>
<p>
Método de integração;
</p>
</li>
<li>
<p>
Tempo real;
</p>
</li>
<li>
<p>
etc.
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/barradesimulacao.png" alt="imagens/barradesimulacao.png" width="700" height="50">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_parâmetros_dos_objetos">Parâmetros dos objetos</h3>
<div class="paragraph"><p>Parâmetros como velocidade de uma junta, torque, PID e força interferem diretamente na simulação, tais parâmentros influenciam na dinâmica do sistema como um todo.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_controlando_a_posição_de_um_robô_com_o_v_rep">Controlando a posição de um robô com o V-REP</h2>
<div class="sectionbody">
<div class="paragraph"><p>Após desenvolver o modelo do robô, partimos para o seu controle de posição. O nosso objetivo é fazer como que a garra (ou a ponta) do robô vá para uma posição desejada. Para isto, utilizaremos a ferramenta de cinemática inversa (FCI) do módulo de cálculo. A FCI utiliza dois <em>Dummies</em> (frames de referência) em seu funcionamento, um no robô e outro que será o alvo. Com essas duas informações, a FCI é capaz de calcular os ângulos das juntas que fazem o <em>dummy</em> que está no robô se encontrar com o <em>dummie</em> alvo, caso isto seja possível.</p></div>
<div class="paragraph"><p>De início, é preciso inserir os dois <em>dummies</em> que serã utilizados pela FCI. No menu superior, vá em add &#8594; dummy. Renomei-o para <strong>garra</strong>. Realize a mesma operação novamente para adicionar outro <em>dummy</em>, e renomei-o para <strong>alvo</strong>.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/dummies1.png" alt="imagens/dummies1.png" width="500" height="350">
</div>
</div>
<div class="paragraph"><p>Agora é preciso conectar os dois <em>dummies</em>. Para isto, clique no <em>dummy</em> <strong>garra</strong> e em seguida, pressionando o botão ctrl, clique no <em>dummy</em> <strong>alvo</strong>. Após selecionar os dois <em>dummies</em> faça: botão direito do mouse &#8594; edit &#8594; link selected dummies &#8594; IK tip-target.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/dummies2.png" alt="imagens/dummies2.png" width="400" height="350">
</div>
</div>
<div class="paragraph"><p>Faça o <em>dummy</em> <strong>garra</strong> ser filho (na árvore hierárquica) da garra do seu robô e em seguida posicione-o sobre a garra.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/dummies3.png" alt="imagens/dummies3.png" width="500" height="350">
</div>
</div>
<div class="paragraph"><p>Abra então a janela do módulo de cálculo. Isto pode ser feito de duas formas: selecionando o botão f(x) na barra de ferramentas 1 ou pelo menu superior em Tools &#8594; Calculation module properties.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ik1.png" alt="imagens/ik1.png" width="400" height="350">
</div>
</div>
<div class="paragraph"><p>Na parte superior da janela do módulo de cálculo, selecione o botão <em>Inverse kinematics</em>. Em seguida, clique em <em>Add new IK group</em>. Deverá aparecer na janela inferior um novo grupo, que por padrão tem nome <em>IK_Group</em>. Modifique o método de cálculo (<em>Calc. method</em>) para DLS. Em seguida clique em <em>Edit IK elements</em> para abrir a janela <em>IK Elements</em>.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ik2.png" alt="imagens/ik2.png" width="250" height="350">
</div>
</div>
<div class="paragraph"><p>Nesta janela, selecione o objeto que será utilizado como ponta (no nosso caso, o <em>dummy</em> <strong>garra</strong>) e clique em <em>Add new IK element with tip:</em>. Vá em <em>Base</em> e selecione a base do seu robô.</p></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/ik3.png" alt="imagens/ik3.png" width="250" height="350">
</div>
</div>
<div class="paragraph"><p>Pronto! Se as juntas do seu robô estiverem configuradas corretamente, basta clicar no botão play e movimentar o <em>dummy</em> <strong>alvo</strong> pelo ambiente que o seu robô tentará alcançá-lo.</p></div>
<div class="paragraph"><p>Mais detalhes sobre a janela do FCI podem ser encontrados em &#8594; <a href="http://www.coppeliarobotics.com/helpFiles/en/ikDialog.htm">janela FCI v-rep</a>.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_gráficos">Gráficos</h2>
<div class="sectionbody">
<div class="ulist compact"><ul>
<li>
<p>
Adicionado através da interface ou de um script
</p>
<div class="ulist"><ul>
<li>
<p>
Inserir
</p>
</li>
<li>
<p>
Configurar
</p>
</li>
<li>
<p>
Setar a visualização
</p>
</li>
<li>
<p>
Visualizando
</p>
</li>
</ul></div>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/adicaografico1.png" alt="imagens/adicaografico1.png" width="500" height="350">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/adicaografico2.png" alt="imagens/adicaografico2.png" width="250" height="350">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/adicaografico3.png" alt="imagens/adicaografico3.png" width="250" height="200">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/adicaografico4.png" alt="imagens/adicaografico4.png" width="500" height="250">
</div>
</div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/adicaografico5.png" alt="imagens/adicaografico5.png" width="500" height="350">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mecanismos_de_controle_2">Mecanismos de controle</h2>
<div class="sectionbody">
<div class="ulist compact"><ul>
<li>
<p>
Scripts Embutidos
</p>
</li>
<li>
<p>
Plugins
</p>
</li>
<li>
<p>
Add-ons
</p>
</li>
<li>
<p>
ROS node
</p>
</li>
<li>
<p>
API remota
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_scripts_embutidos">Scripts Embutidos</h3>
<div class="ulist compact"><ul>
<li>
<p>
Linguagem em Lua
</p>
</li>
<li>
<p>
Possibilidade de criar scripts individuais (modelos construídos)
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/inserindoScriptEmbutido1.png" alt="imagens/inserindoScriptEmbutido1.png" width="550" height="250">
</div>
</div>
<div class="ulist"><ul>
<li>
<p>
Modificar scripts de modelos já predefinidos
</p>
</li>
</ul></div>
<div class="imageblock" style="text-align:center;">
<div class="content">
<img src="imagens/inserindoScriptEmbutido2.png" alt="imagens/inserindoScriptEmbutido2.png" width="550" height="250">
</div>
</div>
<div class="paragraph"><p>A partir dos scripts embutidos podemos ler, setar e aplicar restrições as informações,
tais como: força, velocidade, posição, colisão, tempo, cinemática, proximidade de um
sensor e etc.</p></div>
<div class="paragraph"><p>Exemplo: SimReadProximitySensor e SimSetJointTargetVelocity</p></div>
</div>
<div class="sect2">
<h3 id="_código">Código</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="color: #990000">--</span> pioneer3at<span style="color: #990000">.</span>lua
<span style="color: #990000">--</span> Programa Básico para carregar o Pioneer <span style="color: #993399">3</span><span style="color: #990000">-</span>AT
<span style="color: #990000">--</span>
<span style="color: #990000">--</span> Petrucio Ricardo Tavares de Medeiros
<span style="color: #990000">--</span> Universidade Federal <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> Rio Grande <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> Norte
<span style="color: #990000">--</span> Departamento de Computacao e Automacao Industrial
<span style="color: #990000">--</span> petrucior <span style="color: #008080">at</span> <span style="font-weight: bold"><span style="color: #000000">gmail</span></span> <span style="color: #990000">(</span>dot<span style="color: #990000">)</span> com
<span style="color: #990000">--</span>
<span style="color: #990000">--</span> version <span style="color: #993399">1.0</span>
<span style="color: #990000">--</span> October <span style="color: #993399">2016</span>

<span style="color: #990000">--</span> Configurações básicas <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> modelo
<span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>sim_call_type<span style="color: #990000">==</span>sim_childscriptcall_initialization<span style="color: #990000">)</span> then
    usensors<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">16</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        usensors<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_ultrasonicSensor"</span><span style="color: #990000">..</span>i<span style="color: #990000">)</span>
    end
    motorLeft<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_leftMotor"</span><span style="color: #990000">)</span>
    motorRight<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_rightMotor"</span><span style="color: #990000">)</span>
    noDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.5</span>
    maxDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.2</span>
    detect<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #FF0000">}</span>
    braitenbergL<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">0.2</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.6</span><span style="color: #990000">,</span> <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span>
    braitenbergR<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1.6</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.2</span><span style="color: #990000">,</span> <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span>
    v0<span style="color: #990000">=</span><span style="color: #993399">2</span>
end

<span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>sim_call_type<span style="color: #990000">==</span>sim_childscriptcall_cleanup<span style="color: #990000">)</span> then

end

<span style="color: #990000">--</span> Armazenar no vetor detect as informações dos sensores ultrassons
<span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>sim_call_type<span style="color: #990000">==</span>sim_childscriptcall_actuation<span style="color: #990000">)</span> then
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">16</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        res<span style="color: #990000">,</span>dist<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simReadProximitySensor</span></span><span style="color: #990000">(</span>usensors<span style="color: #990000">[</span>i<span style="color: #990000">])</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>res<span style="color: #990000">&gt;</span><span style="color: #993399">0</span><span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">and</span></span> <span style="color: #990000">(</span>dist<span style="color: #990000">&lt;</span>noDetectionDist<span style="color: #990000">)</span> then
            <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>dist<span style="color: #990000">&lt;</span>maxDetectionDist<span style="color: #990000">)</span> then
                dist<span style="color: #990000">=</span>maxDetectionDist
            end
            detect<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="color: #993399">1</span><span style="color: #990000">-((</span>dist<span style="color: #990000">-</span>maxDetectionDist<span style="color: #990000">)/(</span>noDetectionDist<span style="color: #990000">-</span>maxDetectionDist<span style="color: #990000">))</span>
        <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
            detect<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="color: #993399">0</span>
        end
    end

    <span style="color: #990000">--</span> Definindo valores das velocidade esquerda e direita
    vLeft<span style="color: #990000">=</span><span style="color: #993399">1.8</span>
    vRight<span style="color: #990000">=</span><span style="color: #993399">2.0</span>

    <span style="color: #990000">--</span> Pegando informacoes <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    pioneer<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'Pioneer_p3dx'</span><span style="color: #990000">)</span>
    <span style="color: #990000">--</span> Pegando posicao <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    PosPioneer<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectPosition</span></span><span style="color: #990000">(</span>pioneer<span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">)</span>
    <span style="color: #990000">--</span> Pegando o x <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    t<span style="color: #990000">=</span>PosPioneer<span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">]</span>

    <span style="color: #990000">--</span> Verifica se chegou na referencia
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>t <span style="color: #990000">&gt;</span> <span style="color: #993399">0.0</span><span style="color: #990000">)</span> then
        vLeft <span style="color: #990000">=</span> <span style="color: #993399">0.0</span>
        vRight <span style="color: #990000">=</span> <span style="color: #993399">0.0</span>
    end

    <span style="color: #990000">--</span> Varrer os sensores da frente <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    <span style="color: #990000">--</span><span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">16</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">2</span><span style="color: #990000">,</span><span style="color: #993399">7</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span> detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">&gt;</span> <span style="color: #993399">0</span> <span style="color: #990000">)</span>then <span style="color: #990000">--</span> Se estiver detectando obstáculo
            <span style="color: #990000">--</span> Realiza um desvio para o lado oposto
            vLeft<span style="color: #990000">=</span>vLeft<span style="color: #990000">+</span>braitenbergL<span style="color: #990000">[</span>i<span style="color: #990000">]*</span>detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span>
            vRight<span style="color: #990000">=</span>vRight<span style="color: #990000">+</span>braitenbergR<span style="color: #990000">[</span>i<span style="color: #990000">]*</span>detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span>
        end
    end
    <span style="color: #990000">--</span> Envia informações para os atuadores
    <span style="font-weight: bold"><span style="color: #000000">simSetJointTargetVelocity</span></span><span style="color: #990000">(</span>motorLeft<span style="color: #990000">,</span>vLeft<span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #000000">simSetJointTargetVelocity</span></span><span style="color: #990000">(</span>motorRight<span style="color: #990000">,</span>vRight<span style="color: #990000">)</span>
end
</tt></pre></div></div>
</div>
<div class="sect2">
<h3 id="_descrição_do_programa">Descrição do programa</h3>
<div class="paragraph"><p>Foram incluídas nas primeiras linhas do arquivo <a href="codes/pioneer3at.lua">pioneer3at.lua</a> todas as configurações necessárias para o funcionamento adequado do modelo do robô Pioneer 3-AT.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>sim_call_type<span style="color: #990000">==</span>sim_childscriptcall_initialization<span style="color: #990000">)</span> then
    usensors<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">16</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        usensors<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_ultrasonicSensor"</span><span style="color: #990000">..</span>i<span style="color: #990000">)</span>
    end
    motorLeft<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_leftMotor"</span><span style="color: #990000">)</span>
    motorRight<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_rightMotor"</span><span style="color: #990000">)</span>
    noDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.5</span>
    maxDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.2</span>
    detect<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #FF0000">}</span>
    braitenbergL<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">0.2</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.6</span><span style="color: #990000">,</span> <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span>
    braitenbergR<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1.6</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.2</span><span style="color: #990000">,</span> <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span>
    v0<span style="color: #990000">=</span><span style="color: #993399">2</span>
end</tt></pre></div></div>
<div class="paragraph"><p>Como o Pioneer 3-AT contém 16 sensores utrassons, necessitamos iniciar cada um deles, então o próximo trecho de código realiza a leitura das distâncias e organizam o grau de detecção de cada sensor no vetor <em>detect</em>.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">16</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        res<span style="color: #990000">,</span>dist<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simReadProximitySensor</span></span><span style="color: #990000">(</span>usensors<span style="color: #990000">[</span>i<span style="color: #990000">])</span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>res<span style="color: #990000">&gt;</span><span style="color: #993399">0</span><span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #000000">and</span></span> <span style="color: #990000">(</span>dist<span style="color: #990000">&lt;</span>noDetectionDist<span style="color: #990000">)</span> then
            <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>dist<span style="color: #990000">&lt;</span>maxDetectionDist<span style="color: #990000">)</span> then
                dist<span style="color: #990000">=</span>maxDetectionDist
            end
            detect<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="color: #993399">1</span><span style="color: #990000">-((</span>dist<span style="color: #990000">-</span>maxDetectionDist<span style="color: #990000">)/(</span>noDetectionDist<span style="color: #990000">-</span>maxDetectionDist<span style="color: #990000">))</span>
        <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
            detect<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="color: #993399">0</span>
        end
end</tt></pre></div></div>
<div class="paragraph"><p>Nesse momento do código definimos uma velocidade para os dois atuadores do Pioneer e uma condição de parada dependendo da pose do Pioneer no simulador. Para isso, foi necessário definir qual era o objeto da cena que precisávamos colher informações.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>    <span style="color: #990000">--</span> Definindo valores das velocidade esquerda e direita
    vLeft<span style="color: #990000">=</span><span style="color: #993399">1.8</span>
    vRight<span style="color: #990000">=</span><span style="color: #993399">2.0</span>

    <span style="color: #990000">--</span> Pegando informacoes <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    pioneer<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'Pioneer_p3dx'</span><span style="color: #990000">)</span>
    <span style="color: #990000">--</span> Pegando posicao <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    PosPioneer<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectPosition</span></span><span style="color: #990000">(</span>pioneer<span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">)</span>
    <span style="color: #990000">--</span> Pegando o x <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    t<span style="color: #990000">=</span>PosPioneer<span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">]</span>

    <span style="color: #990000">--</span> Verifica se chegou na referencia
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>t <span style="color: #990000">&gt;</span> <span style="color: #993399">0.0</span><span style="color: #990000">)</span> then
        vLeft <span style="color: #990000">=</span> <span style="color: #993399">0.0</span>
        vRight <span style="color: #990000">=</span> <span style="color: #993399">0.0</span>
    end</tt></pre></div></div>
<div class="paragraph"><p>No código base do Pioneer 3-At do V-Rep já vem configurado a possibilidade de reações há detecção de obstáculos como observado abaixo. São acionadas as velocidades do Robô Pioneer 3-At, representadas por vLeft e vRight, de acordo com a detecção dos sensores.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>    <span style="color: #990000">--</span> Varrer os sensores da frente <span style="font-weight: bold"><span style="color: #0000FF">do</span></span> pioneer
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">2</span><span style="color: #990000">,</span><span style="color: #993399">7</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span> detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">&gt;</span> <span style="color: #993399">0</span> <span style="color: #990000">)</span>then <span style="color: #990000">--</span> Se estiver detectando obstáculo
            <span style="color: #990000">--</span> Realiza um desvio para o lado oposto
            vLeft<span style="color: #990000">=</span>vLeft<span style="color: #990000">+</span>braitenbergL<span style="color: #990000">[</span>i<span style="color: #990000">]*</span>detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span>
            vRight<span style="color: #990000">=</span>vRight<span style="color: #990000">+</span>braitenbergR<span style="color: #990000">[</span>i<span style="color: #990000">]*</span>detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span>
        end
    end</tt></pre></div></div>
<div class="paragraph"><p>Por fim, é necessário enviar as informações de velocidades para os motores.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>    <span style="color: #990000">--</span> Envia informações para os atuadores
    <span style="font-weight: bold"><span style="color: #000000">simSetJointTargetVelocity</span></span><span style="color: #990000">(</span>motorLeft<span style="color: #990000">,</span>vLeft<span style="color: #990000">)</span>
    <span style="font-weight: bold"><span style="color: #000000">simSetJointTargetVelocity</span></span><span style="color: #990000">(</span>motorRight<span style="color: #990000">,</span>vRight<span style="color: #990000">)</span></tt></pre></div></div>
</div>
<div class="sect2">
<h3 id="_plugins_e_add_ons">Plugins e Add-ons</h3>
<div class="paragraph"><p>Duas abordagens bastante semelhantes e que possibilitam a interação de dispositivos externos</p></div>
<div class="ulist compact"><ul>
<li>
<p>
Joysticks e Wii
</p>
</li>
</ul></div>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/GSa8MsBZGIo" frameborder="0" allowfullscreen></iframe>
</p>
<div class="ulist"><ul>
<li>
<p>
Microcontrolador e Sensores
</p>
</li>
</ul></div>
<p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/ZJQV2FlGFBo" frameborder="0" allowfullscreen></iframe>
</p>
</div>
<div class="sect2">
<h3 id="_ros_node">Ros node</h3>
<div class="paragraph"><p>Existem dois plugins disponíveis para possibilitar a comunicação com o Ros</p></div>
<div class="ulist compact"><ul>
<li>
<p>
<a href="http://www.coppeliarobotics.com/helpFiles/en/rosInterf.htm">RosInterface</a>
</p>
</li>
<li>
<p>
<a href="http://www.coppeliarobotics.com/helpFiles/en/rosInterfaceOverview.htm">RosPlugin</a>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_api_remota">Api remota</h3>
<div class="paragraph"><p>Construção de programas externos que se comunicam como clientes com o simulador.</p></div>
<div class="ulist compact"><ul>
<li>
<p>
C++
</p>
<div class="ulist"><ul>
<li>
<p>
Adicione o código em algum diretório
</p>
</li>
<li>
<p>
Copie todos os arquivos do caminho "V-REP/programming/RemoveApi" para um diretório "remoteApi"
</p>
</li>
<li>
<p>
Copie os arquivos "v_repConst.h", "v_repLib.h" e "v_repTypes.h" do caminho "V-Rep/programming/include" para um diretório "include"
</p>
</li>
<li>
<p>
Crie um arquivo Makefile para configuração
</p>
</li>
</ul></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_código_2">Código</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/**</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * \file cliente.cpp</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> *</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * \brief Arquivo para comunicação cliente-servidor com o V-REP.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Este exemplo foi desenvolvido baseado nas aulas obtidas no</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * link </span></span><span style="text-decoration: underline"><span style="color: #0000FF">http://osorio.wait4.org/VREP/.</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> *</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * \author</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Petrucio Ricardo Tavares de Medeiros \n</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Universidade Federal do Rio Grande do Norte \n</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Departamento de Computacao e Automacao Industrial \n</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * petrucior at gmail (dot) com</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> *</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * \version 1.0</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * \date October 2016</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>

<span style="font-style: italic"><span style="color: #9A1900">// Habilite o server antes na simulação V-REP com o comando lua:</span></span>
<span style="font-style: italic"><span style="color: #9A1900">// simExtRemoteApiStart(portNumber) -- inicia servidor remoteAPI do V-REP</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">extern</span></span> <span style="color: #FF0000">"C"</span> <span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #000080">  #include</span></span> <span style="color: #FF0000">"remoteApi/extApi.h"</span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;iostream&gt;</span>
<span style="font-weight: bold"><span style="color: #000080">#include</span></span> <span style="color: #FF0000">&lt;string&gt;</span>

using <span style="color: #008080">namespace</span> std<span style="color: #990000">;</span>

<span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> argc<span style="color: #990000">,</span> <span style="color: #009900">char</span> <span style="color: #990000">**</span>argv<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  <span style="color: #008080">string</span> serverIP <span style="color: #990000">=</span> <span style="color: #FF0000">"127.0.0.1"</span><span style="color: #990000">;</span>
  <span style="color: #009900">int</span> serverPort <span style="color: #990000">=</span> <span style="color: #993399">19999</span><span style="color: #990000">;</span>
  <span style="color: #009900">int</span> leftMotorHandle <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> vLeft <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
  <span style="color: #009900">int</span> rightMotorHandle <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> vRight <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
  <span style="color: #008080">string</span> sensorNome<span style="color: #990000">[</span><span style="color: #993399">16</span><span style="color: #990000">];</span>
  <span style="color: #009900">int</span> sensorHandle<span style="color: #990000">[</span><span style="color: #993399">16</span><span style="color: #990000">];</span>

  <span style="font-style: italic"><span style="color: #9A1900">// variaveis de cena e movimentação do pioneer</span></span>
  <span style="color: #009900">float</span> noDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.5</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> maxDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.2</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> detect<span style="color: #990000">[</span><span style="color: #993399">16</span><span style="color: #990000">]=</span><span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> braitenbergL<span style="color: #990000">[</span><span style="color: #993399">16</span><span style="color: #990000">]=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">0.2</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.6</span><span style="color: #990000">,</span>
 <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> braitenbergR<span style="color: #990000">[</span><span style="color: #993399">16</span><span style="color: #990000">]=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1.6</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.2</span><span style="color: #990000">,</span>
<span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span><span style="color: #990000">;</span>
  <span style="color: #009900">float</span> v0<span style="color: #990000">=</span><span style="color: #993399">2</span><span style="color: #990000">;</span>

  <span style="color: #009900">int</span> clientID<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simxStart</span></span><span style="color: #990000">((</span>simxChar<span style="color: #990000">*)</span>serverIP<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">c_str</span></span><span style="color: #990000">(),</span>serverPort<span style="color: #990000">,</span>
true<span style="color: #990000">,</span>true<span style="color: #990000">,</span><span style="color: #993399">2000</span><span style="color: #990000">,</span><span style="color: #993399">5</span><span style="color: #990000">);</span>

  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>clientID<span style="color: #990000">!=-</span><span style="color: #993399">1</span><span style="color: #990000">)</span>
  <span style="color: #FF0000">{</span>
    cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Servidor conectado!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>

    <span style="font-style: italic"><span style="color: #9A1900">// inicialização dos motores</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">simxGetObjectHandle</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> simxChar<span style="color: #990000">*)</span> <span style="color: #FF0000">"Pioneer_p3dx_leftMotor"</span><span style="color: #990000">,</span>
<span style="color: #990000">(</span>simxInt <span style="color: #990000">*)</span> <span style="color: #990000">&amp;</span>leftMotorHandle<span style="color: #990000">,</span> <span style="color: #990000">(</span>simxInt<span style="color: #990000">)</span> simx_opmode_oneshot_wait<span style="color: #990000">)</span> <span style="color: #990000">!=</span> simx_return_ok<span style="color: #990000">)</span>
      cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Handle do motor esquerdo nao encontrado!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Conectado ao motor esquerdo!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>

    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">simxGetObjectHandle</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> simxChar<span style="color: #990000">*)</span> <span style="color: #FF0000">"Pioneer_p3dx_rightMotor"</span><span style="color: #990000">,</span>
<span style="color: #990000">(</span>simxInt <span style="color: #990000">*)</span> <span style="color: #990000">&amp;</span>rightMotorHandle<span style="color: #990000">,</span> <span style="color: #990000">(</span>simxInt<span style="color: #990000">)</span> simx_opmode_oneshot_wait<span style="color: #990000">)</span> <span style="color: #990000">!=</span> simx_return_ok<span style="color: #990000">)</span>
      cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Handle do motor direito nao encontrado!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Conectado ao motor direito!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>

    <span style="font-style: italic"><span style="color: #9A1900">// inicialização dos sensores (remoteApi)</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> i <span style="color: #990000">&lt;</span> <span style="color: #993399">16</span><span style="color: #990000">;</span> i<span style="color: #990000">++)</span>
    <span style="color: #FF0000">{</span>
      sensorNome<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="color: #FF0000">"Pioneer_p3dx_ultrasonicSensor"</span> <span style="color: #990000">+</span> <span style="font-weight: bold"><span style="color: #000000">to_string</span></span><span style="color: #990000">(</span>i <span style="color: #990000">+</span> <span style="color: #993399">1</span><span style="color: #990000">);</span>

      <span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">simxGetObjectHandle</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,(</span><span style="font-weight: bold"><span style="color: #0000FF">const</span></span> simxChar<span style="color: #990000">*)</span> sensorNome<span style="color: #990000">[</span>i<span style="color: #990000">].</span><span style="font-weight: bold"><span style="color: #000000">c_str</span></span><span style="color: #990000">(),</span>
<span style="color: #990000">(</span>simxInt <span style="color: #990000">*)</span> <span style="color: #990000">&amp;</span>sensorHandle<span style="color: #990000">[</span>i<span style="color: #990000">],</span> <span style="color: #990000">(</span>simxInt<span style="color: #990000">)</span> simx_opmode_oneshot_wait<span style="color: #990000">)</span> <span style="color: #990000">!=</span> simx_return_ok<span style="color: #990000">)</span>
        cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Handle do sensor "</span> <span style="color: #990000">&lt;&lt;</span> sensorNome<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">" nao encontrado!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>
      <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
      <span style="color: #FF0000">{</span>
        cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Conectado ao sensor "</span> <span style="color: #990000">&lt;&lt;</span> sensorNome<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>
        <span style="font-weight: bold"><span style="color: #000000">simxReadProximitySensor</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,</span>sensorHandle<span style="color: #990000">[</span>i<span style="color: #990000">],</span>NULL<span style="color: #990000">,</span>NULL<span style="color: #990000">,</span>NULL<span style="color: #990000">,</span>NULL<span style="color: #990000">,</span>
simx_opmode_streaming<span style="color: #990000">);</span>
      <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span>

    <span style="font-style: italic"><span style="color: #9A1900">// desvio e velocidade do robô</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">while</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">simxGetConnectionId</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">)!=-</span><span style="color: #993399">1</span><span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">// enquanto a simulação estiver ativa</span></span>
    <span style="color: #FF0000">{</span>
      <span style="font-weight: bold"><span style="color: #0000FF">for</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> i <span style="color: #990000">&lt;</span> <span style="color: #993399">16</span><span style="color: #990000">;</span> i<span style="color: #990000">++)</span>
      <span style="color: #FF0000">{</span>
        <span style="color: #008080">simxUChar</span> state<span style="color: #990000">;</span>
        <span style="color: #008080">simxFloat</span> coord<span style="color: #990000">[</span><span style="color: #993399">3</span><span style="color: #990000">];</span>

        <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">simxReadProximitySensor</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,</span>sensorHandle<span style="color: #990000">[</span>i<span style="color: #990000">],&amp;</span>state<span style="color: #990000">,</span>coord<span style="color: #990000">,</span>NULL<span style="color: #990000">,</span>
NULL<span style="color: #990000">,</span>simx_opmode_buffer<span style="color: #990000">)==</span>simx_return_ok<span style="color: #990000">)</span>
        <span style="color: #FF0000">{</span>
          <span style="color: #009900">float</span> dist <span style="color: #990000">=</span> coord<span style="color: #990000">[</span><span style="color: #993399">2</span><span style="color: #990000">];</span>
          <span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span>state <span style="color: #990000">&gt;</span> <span style="color: #993399">0</span> <span style="color: #990000">&amp;&amp;</span> <span style="color: #990000">(</span>dist<span style="color: #990000">&lt;</span>noDetectionDist<span style="color: #990000">))</span>
          <span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span>dist<span style="color: #990000">&lt;</span>maxDetectionDist<span style="color: #990000">)</span>
            <span style="color: #FF0000">{</span>
              dist<span style="color: #990000">=</span>maxDetectionDist<span style="color: #990000">;</span>
            <span style="color: #FF0000">}</span>

            detect<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="color: #993399">1</span><span style="color: #990000">-((</span>dist<span style="color: #990000">-</span>maxDetectionDist<span style="color: #990000">)/(</span>noDetectionDist<span style="color: #990000">-</span>maxDetectionDist<span style="color: #990000">));</span>
          <span style="color: #FF0000">}</span>
          <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
            detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span>
        <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
          detect<span style="color: #990000">[</span>i<span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
      <span style="color: #FF0000">}</span>

      vLeft <span style="color: #990000">=</span> <span style="color: #993399">1.8</span><span style="color: #990000">;</span>
      vRight <span style="color: #990000">=</span> <span style="color: #993399">2.0</span><span style="color: #990000">;</span>

      <span style="font-weight: bold"><span style="color: #0000FF">for</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span> i <span style="color: #990000">&lt;</span> <span style="color: #993399">16</span><span style="color: #990000">;</span> i<span style="color: #990000">++)</span>
      <span style="color: #FF0000">{</span>
        vLeft<span style="color: #990000">=</span>vLeft<span style="color: #990000">+</span>braitenbergL<span style="color: #990000">[</span>i<span style="color: #990000">]*</span>detect<span style="color: #990000">[</span>i<span style="color: #990000">];</span>
        vRight<span style="color: #990000">=</span>vRight<span style="color: #990000">+</span>braitenbergR<span style="color: #990000">[</span>i<span style="color: #990000">]*</span>detect<span style="color: #990000">[</span>i<span style="color: #990000">];</span>
      <span style="color: #FF0000">}</span>

      <span style="font-style: italic"><span style="color: #9A1900">// atualiza velocidades dos motores</span></span>
      <span style="font-weight: bold"><span style="color: #000000">simxSetJointTargetVelocity</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,</span> leftMotorHandle<span style="color: #990000">,</span> <span style="color: #990000">(</span>simxFloat<span style="color: #990000">)</span> vLeft<span style="color: #990000">,</span>
 simx_opmode_streaming<span style="color: #990000">);</span>
      <span style="font-weight: bold"><span style="color: #000000">simxSetJointTargetVelocity</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">,</span> rightMotorHandle<span style="color: #990000">,</span> <span style="color: #990000">(</span>simxFloat<span style="color: #990000">)</span> vRight<span style="color: #990000">,</span>
 simx_opmode_streaming<span style="color: #990000">);</span>

      <span style="font-style: italic"><span style="color: #9A1900">// espera um pouco antes de reiniciar a leitura dos sensores</span></span>
      <span style="font-weight: bold"><span style="color: #000000">extApi_sleepMs</span></span><span style="color: #990000">(</span><span style="color: #993399">5</span><span style="color: #990000">);</span>
    <span style="color: #FF0000">}</span>

    <span style="font-weight: bold"><span style="color: #000000">simxFinish</span></span><span style="color: #990000">(</span>clientID<span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">// fechando conexao com o servidor</span></span>
    cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Conexao fechada!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>
  <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
    cout <span style="color: #990000">&lt;&lt;</span> <span style="color: #FF0000">"Problemas para conectar o servidor!"</span> <span style="color: #990000">&lt;&lt;</span> std<span style="color: #990000">::</span>endl<span style="color: #990000">;</span>
  <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
</tt></pre></div></div>
</div>
<div class="sect2">
<h3 id="_descrição_do_programa_2">Descrição do programa</h3>
<div class="paragraph"><p>Foram incluídas nas primeiras linhas do arquivo <a href="codes/pioneer3at.lua">pioneer3at.lua</a> todas as configurações necessárias para o funcionamento adequado do modelo do robô Pioneer 3-AT.</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.8
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>sim_call_type<span style="color: #990000">==</span>sim_childscriptcall_initialization<span style="color: #990000">)</span> then
    usensors<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #FF0000">}</span>
    <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> i<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">16</span><span style="color: #990000">,</span><span style="color: #993399">1</span> <span style="font-weight: bold"><span style="color: #0000FF">do</span></span>
        usensors<span style="color: #990000">[</span>i<span style="color: #990000">]=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_ultrasonicSensor"</span><span style="color: #990000">..</span>i<span style="color: #990000">)</span>
    end
    motorLeft<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_leftMotor"</span><span style="color: #990000">)</span>
    motorRight<span style="color: #990000">=</span><span style="font-weight: bold"><span style="color: #000000">simGetObjectHandle</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Pioneer_p3dx_rightMotor"</span><span style="color: #990000">)</span>
    noDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.5</span>
    maxDetectionDist<span style="color: #990000">=</span><span style="color: #993399">0.2</span>
    detect<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #FF0000">}</span>
    braitenbergL<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">0.2</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.6</span><span style="color: #990000">,</span> <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span>
    braitenbergR<span style="color: #990000">=</span><span style="color: #FF0000">{</span><span style="color: #990000">-</span><span style="color: #993399">1.6</span><span style="color: #990000">,-</span><span style="color: #993399">1.4</span><span style="color: #990000">,-</span><span style="color: #993399">1.2</span><span style="color: #990000">,-</span><span style="color: #993399">1</span><span style="color: #990000">,-</span><span style="color: #993399">0.8</span><span style="color: #990000">,-</span><span style="color: #993399">0.6</span><span style="color: #990000">,-</span><span style="color: #993399">0.4</span><span style="color: #990000">,-</span><span style="color: #993399">0.2</span><span style="color: #990000">,</span> <span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span><span style="color: #993399">0.0</span><span style="color: #FF0000">}</span>
    v0<span style="color: #990000">=</span><span style="color: #993399">2</span>
end</tt></pre></div></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Last updated 2016-10-21 01:29:08 BRT
</div>
</div>
</body>
</html>
